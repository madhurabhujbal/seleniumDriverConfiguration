var KeeperPBKDF2=function(e,r){var t,n,o=r?asmCrypto.Pbkdf2HmacSha512:asmCrypto.Pbkdf2HmacSha256;e=e||self;try{t=e.crypto||e.msCrypto,n=t.subtle||t.webkitSubtle}catch(e){logger({data:new Error(e),consoleFunction:console.error})}var c,a=(c=new Uint8Array([65]),new Promise(function(e,r){try{return n.importKey("raw",c,"PBKDF2",!1,["deriveBits"]).then(function(){e(!0)}).catch(function(r){e(!1)})}catch(r){e(!1)}})),i=function(e,r,t,n){return new Promise(function(c,a){var i=utf8_to_bytes(e),s=o(i,r,t,n);c(bytes_to_base64urlsafe(s))})};return function(e,r,t){return a.then(function(o){var c="string"==typeof r?(r||"").replace(/-/g,"+").replace(/_/g,"/"):r,a="string"==typeof c?asmCrypto.base64_to_bytes(c):c;return o?(logger({data:"web crypto pbkdf2",consoleFunction:console.log}),function(e,r,t,o){var c=new TextEncoder("utf-8").encode(e);try{return n.importKey("raw",c,"PBKDF2",!1,["deriveBits"]).then(function(e){var c={name:"PBKDF2",salt:r,iterations:t,hash:{name:"SHA-256"}};return n.deriveBits(c,e,8*(o||32))})}catch(e){return Promise.reject(new Error(e))}}(e,a,t,32).then(function(e){return asmCrypto.bytes_to_base64(new Uint8Array(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}).catch(function(r){return logger({data:new Error(r),consoleFunction:console.error}),i(e,a,t,32)})):(logger({data:"asm crypto pbkdf2",consoleFunction:console.log}),i(e,a,t,32))})}},KeeperPBKDF2Offline=function(e,r){e=e||self;var t,n,o=r?"SHA-512":"SHA-256",c=r?64:32,a=r?asmCrypto.Pbkdf2HmacSha512:asmCrypto.Pbkdf2HmacSha256;try{t=e.crypto||e.msCrypto,n=t.subtle||t.webkitSubtle}catch(e){logger({data:new Error(e),consoleFunction:console.error})}var i=new Promise(function(e,r){Promise.resolve().then(function(){var e=new Uint8Array([65]);return n.importKey("raw",e,"PBKDF2",!1,["deriveBits"])}).then(function(){e(!0)}).catch(function(r){e(!1)})}),s=function(e,r,t){return new Promise(function(n,o){var i=utf8_to_bytes(e),s=a(i,r,t,c);n(bytes_to_base64urlsafe(s))})};return function(e,r,t){return i.then(function(a){return a?(logger({data:"web crypto pbkdf2",consoleFunction:console.log}),function(e,r,t){return new Promise(function(a,i){Promise.resolve().then(function(){var r=utf8_to_bytes(e);return n.importKey("raw",r,"PBKDF2",!1,["deriveBits"])}).then(function(e){var a={name:"PBKDF2",salt:r,iterations:t,hash:{name:o}};return n.deriveBits(a,e,8*c)}).then(a).catch(i)})}(e,r,t).then(function(e){return bytes_to_base64urlsafe(new Uint8Array(e))}).catch(function(n){return logger({data:new Error(n),consoleFunction:console.error}),s(e,r,t)})):(logger({data:"asm crypto pbkdf2",consoleFunction:console.log}),s(e,r,t))})}};