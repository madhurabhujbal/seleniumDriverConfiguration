function generateKeyPair(e){return new Promise((t,r)=>crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(e=>crypto.subtle.exportKey("jwk",e.privateKey)).then(e=>{var r=new RSAKey;r.setPrivateEx(convert.base64urlsafe_to_hex(e.n),convert.base64urlsafe_to_hex(e.e),convert.base64urlsafe_to_hex(e.d),convert.base64urlsafe_to_hex(e.p),convert.base64urlsafe_to_hex(e.q),convert.base64urlsafe_to_hex(e.dp),convert.base64urlsafe_to_hex(e.dq),convert.base64urlsafe_to_hex(e.qi));var n=convert.RSAtoASN1Hex(!1,r),i=convert.RSAtoASN1Hex(!0,r);t({public_key:n,private_key:i})}).catch(console.error))}function RSASetPrivateEx(e,t,r,n,i,a,s,u){if(this.isPrivate=!0,this.isPublic=!1,null==e)throw"RSASetPrivateEx N == null";if(null==t)throw"RSASetPrivateEx E == null";if(0==e.length)throw"RSASetPrivateEx N.length == 0";if(0==t.length)throw"RSASetPrivateEx E.length == 0";if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA private key in RSASetPrivateEx";this.n=parseBigInt(e,16),this.e=parseInt(t,16),this.d=parseBigInt(r,16),this.p=parseBigInt(n,16),this.q=parseBigInt(i,16),this.dmp1=parseBigInt(a,16),this.dmq1=parseBigInt(s,16),this.coeff=parseBigInt(u,16)}ASN1HEX.getV=function(e,t){var r=ASN1HEX.getVidx(e,t),n=ASN1HEX.getVblen(e,t);return e.substr(r,2*n)},ASN1HEX.getNextSiblingIdx=function(e,t){return ASN1HEX.getVidx(e,t)+2*ASN1HEX.getVblen(e,t)},ASN1HEX.getLblen=function(e,t){if("8"!=e.substr(t+2,1))return 1;var r=parseInt(e.substr(t+3,1));return 0==r?-1:0<r&&r<10?r+1:-2},ASN1HEX.getVidx=function(e,t){var r=ASN1HEX.getLblen(e,t);return r<0?r:t+2*(r+1)},ASN1HEX.getL=function(e,t){var r=ASN1HEX.getLblen(e,t);return r<1?"":e.substr(t+2,2*r)},ASN1HEX.getVblen=function(e,t){var r;return""==(r=ASN1HEX.getL(e,t))?-1:("8"===r.substr(0,1)?new BigInteger(r.substr(2),16):new BigInteger(r,16)).intValue()},ASN1HEX.getChildIdx=function(e,t){var r=ASN1HEX,n=new Array,i=r.getVidx(e,t);"03"==e.substr(t,2)?n.push(i+2):n.push(i);for(var a=r.getVblen(e,t),s=i,u=0;;){var o=r.getNextSiblingIdx(e,s);if(null==o||o-i>=2*a)break;if(u>=200)break;n.push(o),s=o,u++}return n},RSAKey.getPosArrayOfChildrenFromHex=function(e){return ASN1HEX.getChildIdx(e,0)},RSAKey.getHexValueArrayOfChildrenFromHex=function(e){var t,r=ASN1HEX.getV,n=r(e,(t=RSAKey.getPosArrayOfChildrenFromHex(e))[0]),i=r(e,t[1]),a=r(e,t[2]),s=r(e,t[3]),u=r(e,t[4]),o=r(e,t[5]),l=r(e,t[6]),S=r(e,t[7]),g=r(e,t[8]);return(t=new Array).push(n,i,a,s,u,o,l,S,g),t},RSAKey.prototype.readPKCS5PrvKeyHex=function(e){var t=RSAKey.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},RSAKey.prototype.setPrivateEx=RSASetPrivateEx;