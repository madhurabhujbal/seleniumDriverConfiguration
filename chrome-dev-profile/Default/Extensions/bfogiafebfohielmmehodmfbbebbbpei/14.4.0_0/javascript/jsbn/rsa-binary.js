function pkcs1pad2hex(r,n){if(n<r.length/2+11)return alert("Message too long for RSA"),null;for(var t=new Array,e=r.length;e>=2&&n>0;)t[--n]=parseInt(r.slice(e-2,e),16),e-=2;t[--n]=0;for(var i=new SecureRandom,l=new Array;n>2;){for(l[0]=0;0==l[0];)i.nextBytes(l);t[--n]=l[0]}return t[--n]=2,t[--n]=0,new BigInteger(t)}function pkcs1unpad2hex(r,n){for(var t=r.toByteArray(),e=0;e<t.length&&0==t[e];)++e;if(t.length-e!=n-1||2!=t[e])return null;for(++e;0!=t[e];)if(++e>=t.length)return null;for(var i="";++e<t.length;){var l=255&t[e];i+=l<16?"0"+l.toString(16):l.toString(16)}return i}function RSAEncryptBinary(r){var n=pkcs1pad2hex(r,this.n.bitLength()+7>>3);if(null==n)return null;var t=this.doPublic(n);if(null==t)return null;var e=t.toString(16);return 0==(1&e.length)?e:"0"+e}function RSADecryptBinary(r){var n=parseBigInt(r,16),t=this.doPrivate(n);return null==t?null:pkcs1unpad2hex(t,this.n.bitLength()+7>>3)}RSAKey.prototype.encryptBinary=RSAEncryptBinary,RSAKey.prototype.decryptBinary=RSADecryptBinary;