var sc_regex=new RegExp("[!@#$%]"),digit_regex=new RegExp("[0-9]"),uc_regex=new RegExp("[A-Z]"),char_regex=new RegExp("[A-Za-z]"),howManyCharacters=function(e,r,t){if(-1==t)return!0;for(var n=0,a=0;a<e.length;a++)r.test(e.charAt(a))&&n++;return n>=t},meetsCriteria=function(e,r){return!r.include_symbols==!sc_regex.test(e)&&!r.include_digits==!digit_regex.test(e)&&!r.include_caps==!uc_regex.test(e)&&howManyCharacters(e,uc_regex,r.uppercase_length_letters)&&howManyCharacters(e,digit_regex,r.length_numbers)&&howManyCharacters(e,sc_regex,r.length_symbols)},doGeneratePassword=function(e){var r="0123456789",t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",n="abcdefghijklmnopqrstuvwxyz",a=window.crypto||window.msCrypto,s="";if(e.uppercase_length_letters>-1||e.length_numbers>-1||e.length_symbols>-1){var o="",l="",c="",u="";if(e.uppercase_length_letters>-1)for(var i=e.include_caps?t:"";o.length<e.uppercase_length_letters;)o+=i[a.getRandomValues(new Uint32Array(1))%i.length];if(e.lowercase_length_letters>-1)for(i=n;l.length<e.lowercase_length_letters;)l+=i[a.getRandomValues(new Uint32Array(1))%i.length];if(e.length_numbers>-1)for(;c.length<e.length_numbers;)c+=r[a.getRandomValues(new Uint32Array(1))%r.length];if(e.length_symbols>-1)for(;u.length<e.length_symbols;)u+="!@#$%"[a.getRandomValues(new Uint32Array(1))%"!@#$%".length];s=o+c+u+l;for(var g=(e.include_digits?r:"")+(e.include_caps?t:"")+n+(e.include_symbols?"!@#$%":"");s.length<e.length;)s+=g[a.getRandomValues(new Uint32Array(1))%g.length];return shuffle(s)}var h=(i=(e.include_digits?r:"")+(e.include_caps?t:"")+n+(e.include_symbols?"!@#$%":"")).length,w=(-(h>>=0)>>>0)%h,m="number"==typeof e.length?e.length:16;m>200&&(m=200);for(var p=new Uint32Array(1);s.length<m;){do{p=a.getRandomValues(p)}while(p[0]<w);s+=i[p[0]%h]}return s},generateKeeperPassword=function(e,r,t,n,a,s,o,l){var c,u=(l=l||0)+(a=a||0)+(s=s||0)+(o=o||0),i={length:e>=u?e:u,include_symbols:n,include_digits:t,include_caps:r,uppercase_length_letters:a||-1,length_numbers:s||-1,length_symbols:o||-1,lowercase_length_letters:l||-1};do{c=doGeneratePassword(i)}while(!meetsCriteria(c,i));return c},checkPassword=function(e){var r={password:e,raw:{},score:{className:"",percentage:0,total:0}};e||(e=""),r.raw.length=e.length,r.score.length=4*r.raw.length,r.score.total+=r.score.length,r.raw.upperCaseCount=(e.match(/[A-Z]/g)||[]).length,r.score.upperCaseCount=r.raw.upperCaseCount>0&&r.raw.upperCaseCount<e.length?2*(r.raw.length-r.raw.upperCaseCount):0,r.score.total+=r.score.upperCaseCount,r.raw.lowerCaseCount=(e.match(/[a-z]/g)||[]).length,r.score.lowerCaseCount=r.raw.lowerCaseCount>0&&r.raw.lowerCaseCount<e.length?2*(r.raw.length-r.raw.lowerCaseCount):0,r.score.total+=r.score.lowerCaseCount,r.raw.numberCount=(e.match(/[0-9]/g)||[]).length,r.score.numberCount=r.raw.numberCount<e.length?4*r.raw.numberCount:0,r.score.total+=r.score.numberCount,r.raw.symbolCount=(e.match(/[^a-zA-Z0-9_]/g)||[]).length,r.score.symbolCount=6*r.raw.symbolCount,r.score.total+=r.score.symbolCount,r.raw.middleCount=(e.substring(1,e.length-1).match(/[0-9]/g)||[]).length,r.raw.middleCount+=(e.substring(1,e.length-1).match(/[^a-zA-Z0-9_]/g)||[]).length,r.score.middleCount=2*r.raw.middleCount,r.score.total+=r.score.middleCount,r.raw.requirements=r.raw.length>=8?1:0,r.raw.requirements+=r.raw.upperCaseCount>0?1:0,r.raw.requirements+=r.raw.lowerCaseCount>0?1:0,r.raw.requirements+=r.raw.numberCount>0?1:0,r.raw.requirements+=r.raw.symbolCount>0?1:0,r.score.requirements=2*r.raw.requirements,r.score.total+=r.score.requirements,r.raw.lettersOnly=!!e.match(/^\D+$/),r.score.lettersOnly=r.raw.lettersOnly?0-r.raw.length:0,r.score.total+=r.score.lettersOnly,r.raw.numbersOnly=!!e.match(/^\d+$/),r.score.numbersOnly=r.raw.numbersOnly?0-r.raw.length:0,r.score.total+=r.score.numbersOnly;var t=function(e){for(var r=e.split(""),t=!1,n=0,a=0,s=0;s<r.length;s++){t=!1;for(var o=0;o<r.length;o++)r[s]===r[o]&&s!==o&&(t=!0,a+=Math.abs(r.length/(o-s)));if(t){n++;var l=r.length-n;a=l?Math.ceil(a/l):Math.ceil(a)}}return{raw:n,score:a}}(e);r.raw.repeatCharacters=t.raw,r.score.repeatCharacters=0-t.score,r.score.total+=r.score.repeatCharacters;var n=e.match(/[A-Z]{2,}/g);r.raw.consecutiveUpper=n?n.join("").length-n.length:0,r.score.consecutiveUpper=0-2*r.raw.consecutiveUpper,r.score.total+=r.score.consecutiveUpper;var a=e.match(/[a-z]{2,}/g);r.raw.consecutiveLower=a?a.join("").length-a.length:0,r.score.consecutiveLower=0-2*r.raw.consecutiveLower,r.score.total+=r.score.consecutiveLower;var s=e.match(/[0-9]{2,}/g);r.raw.consecutiveNumber=s?s.join("").length-s.length:0,r.score.consecutiveNumber=0-2*r.raw.consecutiveNumber,r.score.total+=r.score.consecutiveNumber,r.raw.sequentialChar=0;r.raw.sequentialAlpha=0;for(var o=0;o<23;o++){var l="abcdefghijklmnopqrstuvwxyz".substring(o,parseInt(o+3)),c=reverseString(l);-1===e.toLowerCase().indexOf(l)&&-1===e.toLowerCase().indexOf(c)||(r.raw.sequentialAlpha++,r.raw.sequentialChar++)}r.score.sequentialAlpha=0-3*r.raw.sequentialAlpha,r.score.total+=r.score.sequentialAlpha;r.raw.sequentialNumber=0;for(o=0;o<8;o++){l="01234567890".substring(o,parseInt(o+3)),c=reverseString(l);-1===e.toLowerCase().indexOf(l)&&-1===e.toLowerCase().indexOf(c)||(r.raw.sequentialNumber++,r.raw.sequentialChar++)}r.score.sequentialNumber=0-3*r.raw.sequentialNumber,r.score.total+=r.score.sequentialNumber;r.raw.sequentialSymbol=0;for(o=0;o<8;o++){l=")!@#$%^&*()".substring(o,parseInt(o+3)),c=reverseString(l);-1===e.toLowerCase().indexOf(l)&&-1===e.toLowerCase().indexOf(c)||(r.raw.sequentialSymbol++,r.raw.sequentialChar++)}return r.score.sequentialSymbol=0-3*r.raw.sequentialSymbol,r.score.total+=r.score.sequentialSymbol,r.score.total<20?r.score.rating="Very Weak":r.score.total<40?r.score.rating="Weak":r.score.total<60?r.score.rating="Good":r.score.total<80?r.score.rating="Strong":r.score.rating="Very Strong",r.score.percentage=Math.min(Math.max(parseInt(r.score.total),0),100),r.score.className=r.score.rating.toLowerCase().replace(" ","_"),r},reverseString=e=>e.split("").reverse().join(""),shuffle=e=>{for(var r=e.split(""),t=r.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),a=r[t];r[t]=r[n],r[n]=a}return r.join("")};function enforcePasswordComplexity(e,r){return generateKeeperPassword(Math.max(e.ruleLength,r.length),e.uc>0,e.numbers>0,e.special>0,e.uc,e.numbers,e.special,e.lc)}