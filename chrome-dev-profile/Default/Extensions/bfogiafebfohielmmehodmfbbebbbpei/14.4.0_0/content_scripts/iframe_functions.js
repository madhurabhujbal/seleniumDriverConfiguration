function createInnerKeeperElement(e){var t=document.createElement(e),r=window.innerInitFunctionMap[e];return"function"==typeof r&&(t=r(t)),t}function getLanguage(){var e=navigator.language.split("-");if(e.length>1){var t=e[0]+"_"+e[1].toUpperCase();if(-1!==["en_US","ar_AE","de_DE","el_GR","en_GB","es_ES","fr_FR","it_IT","iw_IL","ja_JP","ko_KR","nl_NL","pl_PL","pt_BR","pt_PT","ro_RO","ru_RU","sk_SK","zh_CN","zh_HK","zh_TW"].indexOf(t))return t}return languageFromTwoLetterCode(e[0])}function languageFromTwoLetterCode(e){var t;switch(e){case"ar":t="ar_AE";break;case"de":t="de_DE";break;case"el":t="el_GR";break;case"es":t="es_ES";break;case"fr":t="fr_FR";break;case"it":t="it_IT";break;case"he":case"iw":t="iw_IL";break;case"ja":t="ja_JP";break;case"ko":t="ko_KR";break;case"nl":t="nl_NL";break;case"pl":t="pl_PL";break;case"pt":t="pt_PT";break;case"ro":t="ro_RO";break;case"ru":t="ru_RU";break;case"sk":t="sk_SK";break;case"zh":t="zh_CN";break;default:t="en_US"}return t}function translateThis(e,t,r){return r=r||getLanguage(),translation[r]&&translation[r][e]?translation[r][e]:translation.en_US&&translation.en_US[e]?translation.en_US[e]:(console.warn("missing translation key:",e),t||e)}function capitalize(e){return e[0].toUpperCase()+e.slice(1)}function getFrameDocument(){var e=document;return safariAPI&&!window.supportsCrossOriginExtensionFrames&&getKeeperPositionablePopup()&&(e=getKeeperPositionablePopup().querySelector("iframe").contentDocument),e}function getOverlay(){var e=document;return safariAPI&&!window.supportsCrossOriginExtensionFrames&&getKeeperPositionablePopup()&&(e=getKeeperPositionablePopup().querySelector("iframe").contentDocument),e.querySelector("keeper-extension, keeper-extension-prompt, keeper-extension-simple, keeper-extension-simple-disabled")}function getOverlayPrompt(){var e=document;return safariAPI&&!window.supportsCrossOriginExtensionFrames&&getKeeperPositionablePopup()&&(e=getKeeperPositionablePopup().querySelector("iframe").contentDocument),e.querySelector("keeper-extension-prompt")}function getExtension(){var e=document;return safariAPI&&!window.supportsCrossOriginExtensionFrames&&getKeeperPositionablePopup()&&(e=getKeeperPositionablePopup().querySelector("iframe").contentDocument),e.querySelector("keeper-extension")}function getSubDomain(e){try{return new URL(e).origin.replace(/^.*:\/\//,"")}catch(e){return""}}function onSyncCompleteActiveTab(){var e=getExtension();e&&sendMessage("urlMatchedRecords",{type:"GET",data:{referrer:e.recordGet}},function(t){addRecordsToOverlay(t,e.hints)})}function makesvg(e,t,r,n,i){var a="http://www.w3.org/2000/svg",o=document.createElementNS(a,"svg"),s=document.createElementNS(a,"path");return o.setAttribute("width",t),o.setAttribute("height",r),o.setAttribute("viewBox",n),i&&o.setAttribute("fill",i),s.setAttribute("d",e),o.appendChild(s),o}function keeperThemablePopupConnectedCallback(e){var t=getLanguage();if("ar_AE"===t||"iw_IL"===t?(e.style.direction="rtl",e.classList.add("keeper-rtl")):(e.style.direction="ltr",e.classList.remove("keeper-rtl")),overflowOverrideWhitelisted){let t=e.parentElement;for(;t&&t!==document.body;)t.style.overflow="visible",t=t.parentElement}}function afterAppendKeeperExtension(e){keeperThemablePopupConnectedCallback(e);e.refs={};sendMessage("enforcements",{type:"GET"},t=>{t&&(t.restrict_domain_create&&(e.restrictDomainCreate=verifyDomainEnforcement(t.restrict_domain_create.split(","))),t.restrict_create_identity_payment_records&&(e.restrictCreateIdentityPaymentRecords=!0),t.mask_custom_fields&&(e.maskCustomFields=!0),t.mask_notes&&(e.maskNotes=!0),t.generated_password_complexity&&(e.generated_password_complexity=t.generated_password_complexity,e.generatedPasswordComplexity={}))})}function afterAppendKeeperIconButtonFavicon(e){var t=getOverlay(),r=t.referrer,n=t.faviconUrl,i=document.createElement("keeper-div");i.textContent=r,e.appendChild(i);var a=new Image(16,16);a.src=n,a.onload=function(){e.insertBefore(a,e.firstChild)},a.onerror=function(){var t=document.createElement("keeper-favicon-placeholder"),r=makesvg("M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z","16","16","0 0 24 24");t.appendChild(r),e.insertBefore(t,e.firstChild)}}function showExtension(e,t,r,n,i,a,o,s,c){if(!getOverlay()){var l=createInnerKeeperElement("keeper-extension");return l.id="keeper-extension",l.lockId=n,l.hints=r,l.records=[],l.autoOpened=t,l.referrer=a,l.recordGet=o,l.faviconUrl=s,l.fill=function(e,t){const{displayMode:r}=l;sendMessage("frameFill",{type:"SET",data:{displayMode:r,payload:e,fromFillButton:t}},function(e){e&&sendMessage("closeFrame",{type:"ACTION"})})},l.fillField=function(e,t){var r=l.querySelector("keeper-record").record;sendMessage("frameFillField",{type:"ACTION",data:{lockId:l.lockId,fieldData:t,dataKey:e,record:r}},function({lockId:e,inputType:t,updatedRecord:r}){l.lockId=e;var n=l.querySelector("keeper-record-field-password");n&&(n.restricted&&"password"!==t?n.querySelector("keeper-iconbutton-fill").disabled=!0:n.querySelector("keeper-iconbutton-fill").disabled=!1)})},l.save=function(e){sendMessage("add"+capitalize(e.type),{type:"SET",data:e.record},function(t){handleAddedRecord(t,e.type),l.fill(t.record||t.card||t.address)})},l.addEventListener("mousemove",function(e){clearTimeout(window.activityTimeout),window.activityTimeout=setTimeout(function(){sendMessage("resetInactivityTimeout",{type:"ACTION",data:{broadcast:!0}})},200)}),addOverlayToFrame(l),afterAppendKeeperExtension(l),afterAppendKeeperIconButtonFavicon(l.querySelector("keeper-favicon")),i&&(l.displayMode=i),sendMessage("urlMatchedRecords",{type:"GET",data:{referrer:o,inPageEmail:c}},function(e){addRecordsToOverlay(e,r),safariAPI?updateFrameHeight(15):updateFrameHeight()}),l}}function addRecordsToOverlay({records:e,cards:t,addresses:r,phone:n},i){var a=getOverlay();if(a){if(t&&t.length&&a&&(e.length>0||isKeeperCheckout())&&(a.cards=t),r&&r.length&&a&&e.length>0?a.addresses=r:a.swapButtons(),n&&n.length&&a&&(a.phone=n),e&&e.length>0&&a)if(i.login&&i.login,a.records=e,""===a.login&&""===a.password)a.selectedRecordUid=e[0].record_uid;else{for(var o,s=0;s<e.length;s++){var c=e[s];if(a.login===c.secret1&&a.password===c.secret2){o=c.record_uid;break}a.login!==c.secret1&&a.password!==c.secret2||(o=c.record_uid)}o&&(a.selectedRecordUid=o)}a.onDataUpdated()}}function handleAddedRecord(e,t){var r=getExtension(),n=getOverlayPrompt();if(e&&"success"===e.result)if(r)if("record"===t){var i=e.update_records?e.update_records[0]:e.add_records[0];switch(i.status){case"success":r.dispatchEvent(new CustomEvent("fill",{detail:e[t]}));break;case"access_denied":r.error=translateThis("access_denied");break;default:r.error=translateThis("unexpected_error_with_code").replace("XXX",i.status)}}else r.dispatchEvent(new CustomEvent("fill",{detail:e[t]}));else n&&"record"===t&&(n.records=[e.record]);else r&&e&&(r.error=e.message||e.result_code)}function isKeeperCheckout(){return/^.*(?:keepersecurity|keeperchat).(?:com|eu)$/.test(ourUrl.hostname)&&/checkout/i.test(ourUrl.pathname)}function addOverlayToFrame(e){safariAPI&&!window.supportsCrossOriginExtensionFrames?document.querySelector("keeper-positionable-popup").querySelector("iframe").contentDocument.body.appendChild(e):document.body.appendChild(e)}function updateFrameHeight(e=0){const t=getOverlay();if(t){var r=t.offsetHeight;sendMessage("updateFrameHeight",{type:"ACTION",data:{height:r+e}})}}function updateSettings(e){sendMessage("settings",{type:"SET",data:e})}function makeDisplayExpirationDate(e){var t=e.split(/\//);return t.length>=2?t[1]+"/"+t[0].replace(/^20/,""):""}function overlayAlert(e,t,r,n,i){var a=document.createElement("div"),o=createAndAssign("div",r||{});i?(o.className="overlayalert-enforceMPReentry",a=createAuthenticationErrorMessage()):(a.className="text",a.textContent=e,o.className=n?"overlayalert-enforcePasswordComplexity":"overlayalert"),o.appendChild(a),o.addEventListener("transitionend",function(){this.remove()}),t.appendChild(o),setTimeout(function(){o.classList.add("overlayalertfade")},i?3e3:2e3)}function createAuthenticationErrorMessage(){var e=document.createElement("div"),t=document.createElement("div"),r=document.createElement("div"),n=document.createElement("span"),i=document.createElement("span");e.style.margin="12px",e.style.display="flex",r.style.display="flex",r.style.flexDirection="column",r.style.marginLeft="4px",n.style.flexGrow="1",n.style.marginTop="4px",n.style.marginBottom="12px",n.style.fontSize="14px",i.style.lineHeight="20px";var a=makesvg("M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z","24","24","0 0 24 24");a.querySelector("path").setAttribute("fill","rgb(205, 161, 48)");var o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("d","M0 0h24v24H0V0z"),a.prepend(o),n.innerText=translateThis("ChatAuthenticationRequired"),i.innerText=translateThis("ext_iframe_err"),t.appendChild(a),r.appendChild(n),r.appendChild(i),e.appendChild(t),e.appendChild(r),e}function haltPropagation(e){e.stopPropagation()}function invokeSupers(e){}function createAndAssign(e,t={}){let r={};t.style&&(r=t.style,delete t.style);var n=createInnerKeeperElement(e);const i=Object.assign(n,t);for(let e in r)i.style[e]=r[e];return i}function locationTester(e){return e.test(ourUrl.origin+ourUrl.pathname)}function verifyDomainEnforcement(e){for(var t="",r=0;r<e.length;r++)if(t=e[r].replace(/\*/g,"(?:.*)"),locationTester(new RegExp(t,"i")))return!0;return!1}function slideDown(e,t,r){t=t||"300ms ease",e.style.webkitTransition="initial",e.style.transition="initial",e.style.maxHeight="initial";var n=e.offsetHeight+"px";e.style.maxHeight="0",e.style.overflow="hidden";var i=function(){e.style.removeProperty("-webkit-transition"),e.style.removeProperty("transition"),e.removeEventListener("transitionend",i),r&&r()};e.style.webkitTransition="max-height "+t,e.style.transition="max-height "+t,requestAnimationFrame(function(t){e.addEventListener("transitionend",i),e.style.maxHeight=n})}function slideUp(e,t,r){t=t||"300ms ease",e.style.webkitTransition="initial",e.style.transition="initial";var n=e.offsetHeight+"px";e.style.maxHeight=n,e.style.overflow="hidden";var i=!1,a=function(){e.style.removeProperty("-webkit-transition"),e.style.removeProperty("transition"),e.removeEventListener("transitionend",a),r&&!i&&(i=!0,r())};e.style.webkitTransition="max-height "+t,e.style.transition="max-height "+t,requestAnimationFrame(function(t){e.addEventListener("transitionend",a),e.style.maxHeight="0"})}function fadeOut(e,t,r){t=t||"300ms ease",e.forEach(function(e,n,i){e.style.webkitTransition="initial",e.style.transition="initial",e.style.opacity="1";var a=!1,o=function(){e.style.removeProperty("-webkit-transition"),e.style.removeProperty("transition"),e.removeEventListener("transitionend",o),r&&!a&&(a=!0,r())};e.style.webkitTransition="opacity "+t,e.style.transition="opacity "+t,n===i.length-1&&e.addEventListener("transitionend",o),e.style.opacity="0"})}function fadeIn(e,t,r){t=t||"300ms ease",e.forEach(function(e,n,i){e.style.webkitTransition="initial",e.style.transition="initial",e.style.opacity="0";var a=!1,o=function(){e.style.removeProperty("-webkit-transition"),e.style.removeProperty("transition"),e.removeEventListener("transitionend",o),r&&!a&&(a=!0,r())};e.style.webkitTransition="opacity "+t,e.style.transition="opacity "+t,n===i.length-1&&e.addEventListener("transitionend",o),e.style.opacity="1"})}function generatePasswordComplexities(e,t){if(!e)return null;var r=e.split(",");if(0===(r=_.compact(r.map(e=>{var r="",n=urlComponentJoiner(e.substring(0,e.indexOf("|")));return n.indexOf("*")>-1&&t.forEach(t=>{t.match(n.replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*"))&&(r=e.substring(e.indexOf("|")+1))}),t.forEach(t=>{t.includes(n)&&(r=e.substring(e.indexOf("|")+1))}),r}))).length)return null;var n={ruleLength:0,lc:0,uc:0,numbers:0,special:0,privacyScreen:0};return r.forEach(e=>{var t=e.split("|").map(e=>parseInt(e));n={ruleLength:t[0]>n.ruleLength?t[0]:n.ruleLength,lc:t[1]>n.lc?t[1]:n.lc,uc:t[2]>n.uc?t[2]:n.uc,numbers:t[3]>n.numbers?t[3]:n.numbers,special:t[4]>n.special?t[4]:n.special,privacyScreen:n.privacyScreen||t[5]?1:0}}),n}function urlComponentJoiner(e){if(!/^https?:\/\//.test(e)&&/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/.test(e))return"";if(/^https?:\/\//.test(e)||(e="https://"+e),"https://"==e)return"";try{var{protocol:t,host:r,pathname:n,search:i}=new URL(e)}catch(t){return e}return t+="//",/[!@#$%^&*(),?":{}|<>]/i.test(r)&&(r=unescape(r)),[t,r.replace(/^www\./,""),n,i].slice(1,2).join("")}function getURLsFromCustomAndRecord(e){var t=[];return e&&(e.custom&&e.custom.length>0&&e.custom.forEach(e=>{var r=urlComponentJoiner(e.value);r&&t.push(r)}),e.link&&t.push(e.link)),t}function enforcePrivacyScreen(e,t){var r=generatePasswordComplexities(e,getURLsFromCustomAndRecord(t));return!(!r||!r.privacyScreen)}function getProtocol(e){return new URL(e).protocol}function isTopWindowURLTheFrameURL(e){return e.host===new URL(location.href).host}