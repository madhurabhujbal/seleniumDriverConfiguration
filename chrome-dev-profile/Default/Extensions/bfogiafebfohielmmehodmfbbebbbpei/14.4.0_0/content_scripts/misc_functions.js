const surfaceListenerTarget=/online\.citi\.eu/.test(location.hostname)?document:window;var outerInitFunctionMap;function createOuterKeeperElement(e){var t=document.createElement(e),n=outerInitFunctionMap[e];return"function"==typeof n&&(t=n(t)),sanityCheckAllImportantCSS(t)}function hostFromURL(e){if(!e)return"";try{var t=new URL(e);return"file://"!==t.origin?t.hostname:t.href}catch(t){if(0!==e.indexOf("http"))return hostFromURL("https://"+e.trim())}}function domainFromURL(e){var t=hostFromURL(e);if(t){var n=t.split("."),r=n[n.length-1],o=n[n.length-2];return"com"===r||"net"===r||"org"===r?n.slice(-2).join("."):o&&2===r.length&&"com"===o?n.slice(-3).join("."):n.length<=2?t:n.slice(1).join(".")}return t}function getKeeperPositionablePopup(){return document.querySelector("keeper-positionable-popup")}function pageHasCaptcha(){return!!document.querySelector('iframe[src*="captcha"]')}function groupHasCaptcha(e){return!!e.ancestor.querySelector('iframe[src*="captcha"]')}function smartFill(e={},t={},n=[],r){if(canFillFrameWith(e)){var o=makeInputReadyForTraffic(t.elems.entries().next().value[0]);sendMessage("masterPasswordReEntry",{type:"GET",data:{fromIframe:!1,closeWindow:!0,action:"fill"}},function(e){if(e)"http:"===getProtocol(ourUrl)?sendMessage("confirmFromIframe",{type:"ACTION",message:translateThis("autofill_fill_http").replace("XXX",ourUrl.host),input:o},function(e){e&&i()}):i();else{var t=getKeeperPositionablePopup();sendMessage("showMPRentryErrorPopup",{type:"ACTION"}),t.MPReentry=function(){i()}}})}function i(){KeeperFill.clearCustomFillInterval();let r=null,o=null;switch(t.type){case"card":if(e.billing_address)for(let n of t.elems.entries()){"address"===KeeperFill.utils.detectElementType(n)&&(o=e.billing_address)}r=KeeperFill.executeCreditCardFill(e,t);break;case"address":o?r=r.then(e=>KeeperFill.executeAddressFill(o,t)):r||(r=KeeperFill.executeAddressFill(e,t));break;case"record":if(e.extra&&"object"==typeof e.extra.smartfill){var i=!1;Object.keys(e.extra.smartfill).forEach(t=>{var n=null;try{n=KeeperFill.utils.querySelector(t)}catch(n){delete e.extra.smartfill[t],i=!0}if(n){let r=e.extra.smartfill[t],o=e[r];e.custom.some(e=>{if(e.name===r)return o=e.value,!0}),o&&("password"!=n.type&&"secret2"!=r||"password"==n.type&&"secret2"==r)&&KeeperFill.utils.fillInput(n,o)}}),i&&sendMessage("setSmartfill",{type:"SET",data:e})}r=KeeperFill.executeLoginFill(e,t);break;case"changepassword":r=KeeperFill.executeChangePasswordFill(e,t);break;case"registration":r=KeeperFill.executeRegistrationFill(e,t);break;default:return Promise.reject("Couldnt fill because event tagname didn't match... This should never happen")}return["record","changepassword","registration"].indexOf(t.type)>-1&&sendMessage("updateRecordLastFilled",{type:"SET",data:e}),r.then(r=>{var o=!0;n&&n.forEach(e=>{findInputWithInformation(e.field)&&Date.now()-e.time<5e3&&(o=!1)});var i=KeeperFill.utils.detectSubmitButton(t.elems,t.ancestor)||KeeperFill.utils.getElementById("LoginButton");return i&&i.disabled&&(i.disabled=!1),i&&"record"===t.type&&r>=1&&sendMessage("settings",{type:"GET"},t=>{t.autoSubmit&&e&&o&&setTimeout(function(){i.click(),i.ksClickCallback&&i.ksClickCallback()},50)}),{count:r,submitButton:i}}).then(({count:n,submitButton:r})=>("registration"!==t.type||noReregister||KeeperFill.detectBestGroups().then(n=>{function o(){n.registrationGroup&&allFieldsHaveInput(t&&t.elems?t.elems:null)&&usernameIsRejected(e,t&&t.elems?t.elems:null)&&KeeperPromptManager.tryReRegistration(e)}r&&r.addEventListener("click",function(){setTimeout(o,2e3)})}),n)).catch(e=>console.error(e))}}function usernameIsRejected(e,t){if(!t)return!1;for(var n of t.keys()){if(KeeperFill.isEmail(n))if(KeeperFill.utils.getElementById(n.id).value==e.secret1)return!0}return!1}function allFieldsHaveInput(e){if(!e)return!1;for(var t of e.keys())if(!t||null===t.value||""===t.value)return!1;return!0}function pickGroup(e){if(!e||!Object.keys(e).length)return null;const t=getKeeperPositionablePopup();let n=null;const r=Object.values(e).filter(Boolean).sort((e,t)=>e.elems.size-t.elems.size).sort((e,t)=>t.integrity-e.integrity);if(t){var o=KeeperFill.utils.getElementById(t.lockId);if(o){let e=o.attachedInput;n=r.find(t=>t.elems.has(e))||null}else if(t.lockId&&t.relativeFrameLockBounds){var i=a(t.relativeFrameLockBounds);function a(e){return{x:e.left+(e.right-e.left)/2,y:e.top+(e.bottom-e.top)/2}}function s(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}n=r.sort((e,t)=>{var n=a(e.ancestor.getBoundingClientRect()),r=a(t.ancestor.getBoundingClientRect());return s(n,i)-s(r,i)})[0]}else n=r[0]||null}else n=r[0];return n}function showKeeper(e){if(!1!==e.isTrusted){var t=e.target;e.stopPropagation(),sendMessage("isLoggedIn",{type:"GET"},e=>{sendMessage("disable_tab",{type:"GET"},n=>{n?showDisableTab(t):e?showLoggedInKeeper(t):showLoggedOutKeeper(t)})})}}function getInPageEmail(e){const t=/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/;var n=e||document.body,r=!1;if(n&&n.children&&n.children.length&&n.children.length>0){for(;t.test(n.textContent)&&n.children&&n.children.length>0;){for(var o=0;o<n.children.length;o++){if(t.test(n.children[o].textContent)){n=n.children[o];break}o+1==n.children.length&&(r=!0)}if(r)return i(n,t)}return i(n,t);function i(e,t){try{return(e.textContent.match(t)||[]).filter(e=>!1===/\.png$/.test(e))[0]}catch(e){return null}}}return null}function removeChildrenElements(e){return e&&e.children&&e.children.length&&e.children.length>0&&e.children.forEach(e=>e.remove()),e}function getSelectorFromElement(e){let t="";return e.id&&(t+="#"+e.id),e.className&&(t+="."+e.className.replace(/(^\s+|\s+$)|(\s+)/g,function(e,t,n){return n?".":""})),e.attributes.type&&(t+=`[type="${e.type}"]`),e.attributes.name&&(t+=`[name="${e.name}"]`),t}function appendKeeperPromptFrame(e,t,n){return new Promise(n=>{let r=getBaseUrl();var o=createOuterKeeperElement("keeper-positionable-popup");o.setAttribute("id","keeper-extension-popup"),o.setAttribute("name",e);o.style.cssText=["z-index:2147483647 !important;","height:220px !important;","width:294px !important;","position:fixed !important;","opacity:1.0 !important;","clip-path:none !important;","clip:auto !important;","mask:none !important;","transform:none !important;"].join(""),o.lockId=t,document.querySelector("frameset")?(document.querySelector("frameset").parentNode.appendChild(o),afterAppendContainer(o)):(document.body.appendChild(o),afterAppendContainer(o));let i=document.createElement("iframe");i.onload=function(){n(!0)},safariAPI?window.supportsCrossOriginExtensionFrames&&(i.src=`${r}/content_scripts/prompt.html`):i.src=`${r}/content_scripts/prompt.html`,i.style.cssText="position:absolute !important;top:0 !important;left:0 !important;height:100% !important;margin:0 !important;padding:0 !important;display:block !important;width:100% !important;",o.appendChild(i),removeListenersFromCraigSpecificSites(ourUrl)})}function afterAppendContainer(e){var t=e.appendChild(document.createElement("keeper-header"));if(afterAppendHeader(t),"showLoggedInKeeper"===e.getAttribute("name")){var n=t.querySelector("keeper-div"),r=createOuterKeeperElement("keeper-iconbutton-more");function o(e){var t=document.querySelector("keeper-iconbutton-more keeper-div");t&&(t.style.display="none")}function i(e,t){sendMessage("enforcements",{type:"GET"},n=>{sendMessage("whichTabIsHighlighted",{type:"GET"},r=>{if("record"===r)if(n&&n.restrict_domain_create&&verifyDomainEnforcement(n.restrict_domain_create.split(","))&&!0!==t)sendMessage("roleEnforcementRestriction",{type:"ACTION"});else{if(!1===e.isTrusted)return;document.addEventListener("mouseup",o),sendMessage("editMode",{type:"ACTION",data:t})}else if(n&&n.restrict_create_identity_payment_records&&!0!==t)sendMessage("roleEnforcementRestriction",{type:"ACTION"});else{if(!1===e.isTrusted)return;document.addEventListener("mouseup",o),sendMessage("editMode",{type:"ACTION",data:t})}})})}n.appendChild(r),r.refs.newButton.onmouseup=function(e){i(e,{})},r.refs.editButton.onmouseup=function(e){i(e,!0)},r.refs.changePasswordButton.onmouseup=function(e){sendMessage("showChangePrompt",{type:"ACTION"})};var a=createOuterKeeperElement("keeper-iconbutton-done");n.appendChild(a),a.style.display="none",a.style.cursor="pointer",a.setAttribute("keeper-tooltip",translateThis("Fill_and_save"))}e.style.visibility="hidden"}function afterAppendHeader(e){e.appendChild(document.createElement("keeper-logo")),e.appendChild(document.createElement("keeper-div")),e.appendChild(createOuterKeeperElement("keeper-iconbutton-close"));const t=e.parentNode;e.querySelector("keeper-iconbutton-close").style.cursor="pointer",e.querySelector("keeper-iconbutton-close").onmouseup=function(e){sendMessage("clearPromptableLoginData",{type:"SET"}),sendMessage("restoreLocks",{type:"ACTION"}),t.lock&&t.lock.style&&(t.lock.style.opacity="");sendMessage("closeFrame",{type:"ACTION"})},e.onmousedown=(n=>{e._movable=!0,t.clientX=n.clientX,t.clientY=n.clientY,document.body.style.cursor=e.style.cursor="move"}),e.addEventListener("mouseup",e._mouseup_handler=(t=>{e._movable=!1,document.body.style.cursor=e.style.cursor=""})),surfaceListenerTarget.addEventListener("mouseup",e._mouseup_handler=(t=>{e._movable=!1,document.body.style.cursor=e.style.cursor=""})),surfaceListenerTarget.addEventListener("mousemove",e._mousemove_handler=(n=>{e._movable?(t.style.left=t.offsetLeft-(t.clientX-n.clientX)+"px",t.style.top=t.offsetTop-(t.clientY-n.clientY)+"px",t.style.margin="0px 0px 0px 0px",t.clientX=n.clientX,t.clientY=n.clientY,sendMessage("updateExtensionClasses",{type:"ACTION",data:{classesToAdd:["keeper-float"],classesToRemove:["keeper-left","keeper-right"]}}),overlay_sanity.left=t.style.left,overlay_sanity.top=t.style.top):(t.style.left=overlay_sanity.left,t.style.top=overlay_sanity.top)}))}function afterAppendIconClose(e){}function afterAppendIconMore(e){}function afterAppendIconDone(e){}function showDisableTab(e){getKeeperPositionablePopup()&&getKeeperPositionablePopup().remove(),sendMessage("openFrame",{type:"ACTION",data:{name:"showDisabledKeeper",lockId:e?e.id:lockId||null}},function(t){sendMessage("showExtensionFromFrame",{type:"ACTION",data:{header:translateThis("extension_prompt_to_disable_header"),message:translateThis("extension_prompt_to_disable"),lock:e||null,lockId:e?e.id:lockId||null,lockBounds:e?getBoundingClientRect(e):null,frameSrc:inFrame?document.location.href:null}})}),e&&(e.style.opacity="1")}function showLoggedInKeeper(e,t,n,r,o,i,a){sendMessage("resetInactivityTimeout",{type:"ACTION",data:{broadcast:!0}}),KeeperPromptManager.hasPrompted=!0,e&&!e.fromContextMenu&&(KeeperFill.utils.clickedLock=e),n=n||{},e&&e.attachedInput&&(n="password"===e.attachedInput.type?{login:getLoginValue(),password:e.attachedInput.value}:{login:e.attachedInput.value,password:getPasswordValue()},e.style&&e.style.setProperty("opacity","1","important")),n.title=document.title,n.link=ourUrl.origin+ourUrl.pathname,r=e?e.fromContextMenu?e.attachedInput.id:e.id:null;const s=e?e.fromContextMenu?getBoundingClientRect(e.attachedInput):getBoundingClientRect(e):null;var l=getInPageEmail();sendMessage("openFrame",{type:"ACTION",data:{name:"showLoggedInKeeper",lockId:r}},function(o){i?sendMessage("showExtensionFromFrame",{type:"ACTION",data:{isProactive:t,hints:n||{},lockId:e?e.fromContextMenu?e.attachedInput.id:e.id:null,groupType:null,lockBounds:s,frameSrc:inFrame?document.location.href:null,referrer:ourUrl.hostname||ourUrl.pathname,recordGet:ourUrl.href||ourUrl.hostname,faviconUrl:getFaviconUrl(),inPageEmail:l}},e=>{i()}):a?sendMessage("showExtensionFromFrameByPrompt",{type:"ACTION",data:{isProactive:t,hints:n||{},lockId:r,groupType:null,lockBounds:s,frameSrc:inFrame?document.location.href:null,referrer:ourUrl.hostname||ourUrl.pathname,recordGet:ourUrl.href||ourUrl.hostname,faviconUrl:getFaviconUrl(),inPageEmail:l}}):KeeperFill.detectBestGroups().then(e=>{const o=pickGroup(e);sendMessage("showExtensionFromFrame",{type:"ACTION",data:{isProactive:t,hints:n||{},lockId:r,groupType:o&&("changepassword"===o.type||"registration"===o.type?"record":o.type),lockBounds:s,frameSrc:inFrame?document.location.href:null,referrer:ourUrl.hostname||ourUrl.pathname,recordGet:ourUrl.href||ourUrl.hostname,faviconUrl:getFaviconUrl(),inPageEmail:l}})}).catch(e=>console.error(e))})}function findNextLock(e){for(var t=KeeperFill.utils.querySelectorAll("keeper-lock"),n=null,r=0;r<t.length;r++)if(t[r].isSameNode(e)){if(r===t.length-1)break;n=t[r+1];break}return n}function findNextInput(e){for(var t=KeeperFill.utils.querySelectorAll("input").filter(t=>!!(e.form&&t.form&&t.type&&"checkbox"!=t.type&&"submit"!=t.type)&&e.form.id==t.form.id),n=null,r=0;r<t.length;r++)if(t[r].isSameNode(e)){if(r===t.length-1)break;n=t[r+1];break}return n}function getFaviconUrl(){var e=document.head.querySelector("link[rel=icon]"),t=document.head.querySelector('link[rel="shortcut icon"]');return e&&e.href?e.href:t&&t.href?t.href:ourUrl.origin+"/favicon.ico"}function getBoundingClientRect(e){if(e&&e.fromContextMenu){var t,n=getKeeperPositionablePopup(),r=n?n.getBoundingClientRect():null,o=e.attachedInput?e.attachedInput.getBoundingClientRect():e.getBoundingClientRect(),i=e.attachedInput?getComputedStyle(e.attachedInput):getComputedStyle(e),a={top:-window.scrollY,left:-window.scrollX},s=o.top-a.top+(o.height-(e.attachedInput?e.attachedInput.offsetHeight?e.attachedInput.offsetHeight:0:e.offsetHeight))/2;return t="right"===i.textAlign?o.left-a.left+(parseInt(i.paddingLeft)||3):r?o.width>=r.width?o.left+o.width-r.width:o.left-(r.width-o.width):o.left-a.left+o.width-(e.attachedInput?e.attachedInput.offsetWidth?e.attachedInput.offsetWidth:0:e.offsetWidth)-(parseInt(i.paddingRight)||3),{top:s,right:o.right,bottom:o.bottom,left:t,width:o.width,height:o.height,x:o.x,y:o.y,fromContextMenu:e.fromContextMenu}}{const t=e.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height,x:t.x,y:t.y}}}function resolveLockBounds(e,t){var n=new URL(e),r=`iframe[src="${e}"], frame[src="${e}"]`;n.pathname.length>1&&(r+=`, iframe[src="${n.pathname}"]`);var o=KeeperFill.utils.querySelector(r);if(o){var i=o.getBoundingClientRect(),a=window.getComputedStyle(o),s={left:parseInt(a.getPropertyValue("padding-left")),top:parseInt(a.getPropertyValue("padding-top")),right:parseInt(a.getPropertyValue("padding-right")),bottom:parseInt(a.getPropertyValue("padding-bottom"))};return t.left=t.left+i.left+s.left,t.top=t.top+i.top+s.top,t.right=t.left+t.width,t.bottom=t.top+t.height,t}return null}function showLoggedOutKeeper(e){getKeeperPositionablePopup()&&getKeeperPositionablePopup().remove(),sendMessage("openFrame",{type:"ACTION",data:{name:"showLoggedOutKeeper",lockId:e?e.id:lockId||null}},function(t){sendMessage("showExtensionFromFrame",{type:"ACTION",data:{message:translateThis("extension_prompt_to_login"),lock:e||null,lockId:e?e.id:lockId||null,lockBounds:e?getBoundingClientRect(e):null,frameSrc:inFrame?document.location.href:null}})}),e&&(e.style.opacity="1")}function canFillFrameWith(e){if(!inFrame)return!0;if(e.custom&&e.custom.length>0){var t=e.custom.filter(e=>{try{var t=e.value.slice(0);/^https?:\/\//.test(t)||(t="https://"+t);new URL(t);return!0}catch(e){return!1}});t.push({name:"payloadlink",value:e.link});for(var n=0;n<t.length;n++)if(domainFromURL(t[n].value)===domainFromURL(location.href)||checkCrossOriginAllowed(t[n].value,location.host)){if(isNotInSandboxedIframe())return!0}else;return!1}if(domainFromURL(e.link)!==domainFromURL(location.href)){if(!checkCrossOriginAllowed(e.link,location.host))return!1}return isNotInSandboxedIframe()}function isNotInSandboxedIframe(){try{const e=sandblaster.detect();return!(e&&e.sandboxed&&e.sandboxAllowances&&!e.sandboxAllowances.sameOrigin)}catch(e){return!1}}function autoFill(e,t){var n=getKeeperPositionablePopup();if(n&&n.style&&0===n.style.opacity)return;const r=document.body.getBoundingClientRect();if(0!==r.width||0!==r.height){var{displayMode:o,payload:i,fromFillButton:a}=e;if(!canFillFrameWith(i))return;KeeperFill.detectBestGroups().then(t=>new Promise((n,r)=>{const{changepasswordGroup:s,registrationGroup:l,addressGroup:c,loginGroup:u,cardGroup:d}=t;let p=null;switch(o){case"record":{let t;if(e.lastInputField){t=findInputWithInformation(JSON.parse(e.lastInputField));let r=[];s&&r.push(s),u&&r.push(u),l&&r.push(l);let o=getGroupsElementIsIn(t,getGroupsWithHighestIntegrity(r));if(o.length||n(-1),1===o.length){p=o[0];break}}s?p=s:(u||l)&&(p=pickGroup({loginGroup:u,registrationGroup:l}));break}case"card":!(p=d)&&c&&i.billing_address&&(i=i.billing_address,p=c);break;case"address":p=c}p?sendMessage("lastFillTimeOnInputField",{type:"GET",data:{record:i}},function(e){n(smartFill(i,p,e,a))}):n(-1)})).then(e=>{e<1&&"record"===o||sendMessage("successfulAutoFill",{type:"SET",data:{count:e}}),t&&t(e)}).catch(e=>console.error(e))}}function getGroupsWithHighestIntegrity(e){if(!e.length)return[];e.sort((e,t)=>e.integrity-t.integrity);const t=e[e.length-1].integrity;return e=e.filter(e=>e.integrity===t)}function getGroupsElementIsIn(e,t){return t.filter(t=>t.elems.has(e))}function onLoggedIn(){injectInputLocks();var e=getKeeperPositionablePopup();e&&e.remove(),KeeperPromptManager.hasPrompted=!1}function onSyncComplete(){var e=KeeperFill.utils.querySelectorAll("keeper-lock");Array.prototype.forEach.call(e,function(e){e.loading=!1})}function onLoggedOut(){var e=KeeperFill.utils.querySelectorAll("keeper-lock");Array.prototype.forEach.call(e,function(e){e.disabled=!0}),injectInputLocks();var t=getKeeperPositionablePopup();t&&t.remove()}function saveInputValues(){var e=getInputValues();if(e.login&&1===e.passwords.length){var t={login:e.login,password:e.passwords[0],link:ourUrl.origin+ourUrl.pathname,title:document.title||"AutoSaved Record"};sendMessage("promptableLoginData",{type:"SET",data:t})}}function getInputValues(){var e={login:null,passwords:[]};if(maskedInputs){var t=KeeperFill.utils.getElementById(maskedInputs.username),n=KeeperFill.utils.getElementById(maskedInputs.password);t&&""!==t.value&&n&&""!==n.value&&(e.login=t.value,e.passwords.push(n.value))}else{for(var r=KeeperFill.utils.querySelectorAll('[data-keeper-edited="yes"], [data-keeper-lock-id], input[type="text"][name="email"],input[type="hidden"][name="displayName"], input[type="hidden"][name="login"]'),o=0;o<r.length;o++){let t=r[o];if(t.value&&-1===t.value.indexOf("***")){if(KeeperFill.isFirstName(t)||KeeperFill.isLastName(t))break;if(e.login||!KeeperFill.isLogin(t)&&!KeeperFill.isEmail(t)&&"displayName"!==t.name){if(KeeperFill.isPassword(t))e.passwords.push(t.value);else if(e.login&e.passwords.length)break}else e.login=t.value}}e.login||/wiki.industrysafe.com/.test(location.href)||(e.login=getInPageEmail())}return e}function getLoginValue(){return/signin.aws.amazon/.test(location.hostname)?(console.warn("Is AWS sigin; ignoring typed logins (their are two login fields)"),""):getInputValue(!1)}function getPasswordValue(){return getInputValue(!0)}function getInputValue(e){var t="",n=KeeperFill.utils.querySelectorAll("keeper-lock");return Array.prototype.forEach.call(n,function(n){n.attachedInput&&n.attachedInput.value&&"password"===n.attachedInput.type===(e||!1)&&(t=n.attachedInput.value)}),t}function getInputWidth(e){return e.getBoundingClientRect().width}function fillLockAttachedInput(e,t,n){KeeperFill.utils.fillInput(e.attachedInput,t),"newPassword"===n?sendMessage("newPasswordFilled",{type:"ACTION"}):"oldPassword"===n&&sendMessage("oldPasswordFilled",{type:"ACTION"})}function removeAllLocks(){KeeperFill.utils.querySelectorAll("keeper-lock").forEach(e=>{e.remove()})}function legacyGetInputsForLocks(){var e=getDocumentSearchWord(),t=new RegExp(e,"i");return KeeperFill.utils.querySelectorAll("input").filter(n=>{let r=(e,t)=>new RegExp(t.map(t=>`${t}=".*?${e}.*?" ?`).join("|"),"i").test(n.outerHTML);switch(!0){case n.maxLength<3&&-1!==n.maxLength&&!KeeperFill.isMonth(n)&&!KeeperFill.isYear(n):case getInputWidth(n)<=40:case""===n.type||!/^(tel|text|email|number|password|input)$/.test(n.type):case"Untitled"===n.value:case!1===isElementRendered(n):case void 0!==n.dataset.keeperIgnore:case n.classList.contains("docs-title-input"):case/^true$/.test(n.getAttribute("aria-hidden")):case r("(?:zoom|font[-_ ]?size)",["aria-label"]):case/^(?:q|s|query|subjectbox)$/.test(n.getAttribute("name")):case r(e,["id","class","name","type","placeholder","title","value","aria-label"]):case t.test(n.outerHTML):case/search/i.test(n.outerHTML)||/search/i.test(n.parentNode.outerHTML):case r("Find in",["placeholder"]):case r("(?:datapicker|datepicker|select2-focusser)",["class"]):case r("(?:qty|quantity)",["id","name","class"]):case r("keeper-ignore",["id","name","class"]):case"number"===n.type&&!r("card",["id","class","name","placeholder"]):case r("(?:start|end|depart(ure)?|return)[-_ ]?(?:date|time)",["aria-label","name","id","class"]):case r("offers",["id"]):case/www\.facebook\.com/.test(location.origin)&&r("recovery_code_entry|code_in_cliff",["id"]):case r("(?:project-field|summary|issuetype|priority-field|assignee-field|duedate)",["id","name"]):case r("(?:Add a comment|What needs to be done)",["placeholder"]):case"https://keeper.atlassian.net"===location.origin&&r("text",["class"])&&"creditcard-name"!=n.id:case r("waffle-range-selection-input",["class"]):case r("(?:calendar|Add title|Owner|Organization|Time Zone)",["aria-label"]):case"https://calendar.google.com"===location.origin&&r("text",["type"]):case location.origin.includes("workable.com")&&location.pathname.includes("backend"):case/www\.usedvictoria\.com/.test(location.origin)&&/^demo$/.test(n.getAttribute("id")):case/www\.usedvictoria\.com/.test(location.origin)&&r("custom-combobox-input",["class"]):case/karpus\.investcloud\.com/.test(location.origin)&&r("ErrorField",["id"]):return!1;default:return!0}})}function pageHasOpenShadowRoot(){const e=document.querySelectorAll("*");for(var t=0;t<e.length;t++)if(e[t].shadowRoot)return!0;return!1}function getInputsForLocks(){var e=[];return KeeperFill.utils.querySelectorAll("input:not([type=checkbox]):not([type=submit])").filter(e=>KeeperFill.isVisible(e)&&!KeeperFill.isSubmit(e)&&(KeeperFill.isLogin(e)||KeeperFill.isPassword(e))&&(e.form&&(Array.from(e.form).some(isTypePasswordAndKeeperFillPassword)||isVisibleUernameOrEmail(e))||KeeperFill.isPassword(e)||!e.form)&&!KeeperFill.isCardNumber(e)&&!KeeperFill.isExpiration(e)&&!KeeperFill.isMonth(e)&&!KeeperFill.isYear(e)&&!KeeperFill.isVerification(e)&&!KeeperFill.isCardHolderName(e)&&!KeeperFill.isCardTitle(e)&&!KeeperFill.isCardType(e)&&!KeeperFill.isAddress(e)&&!KeeperFill.isStreet(e)&&!KeeperFill.isLine1(e)&&!KeeperFill.isLine2(e)&&!KeeperFill.isPhone(e)&&!KeeperFill.isCity(e)&&!KeeperFill.isState(e)&&!KeeperFill.isZip(e)&&!KeeperFill.isCountry(e)&&"FIELDSET"!=e.tagName&&e.classList&&e.classList.contains&&!e.classList.contains("keeper-ignore")).forEach(t=>{if(t.form){var n=Array.from(t.form).filter(e=>"checkbox"!=e.type&&"hidden"!=e.type&&"submit"!=e.type&&"radio"!=e.type&&"button"!=e.type&&"BUTTON"!=e.tagName&&"SELECT"!=e.tagName&&"FIELDSET"!=e.tagName&&!KeeperFill.isSubmit(e));e=e.concat(n)}else e=e.concat([t])}),_.uniq(e)}function isTypePasswordAndKeeperFillPassword(e){return KeeperFill.isPassword(e)&&"password"===e.type}function isVisibleUernameOrEmail(e){return!!e.form&&Array.from(e.form).filter(e=>KeeperFill.isVisible(e)&&"SELECT"!=e.tagName&&"FIELDSET"!=e.tagName&&e.type&&"button"!=e.type&&"submit"!=e.type&&"checkbox"!=e.type&&!KeeperFill.isPassword(e)).every(KeeperFill.isLogin||KeeperFill.isEmail)}function injectInputLocks(){isKeeper()||(KeeperFill.checkShadowRoots=pageHasOpenShadowRoot(),sendMessage("inject_locks_data",{type:"GET"},({settings:e,isLoggedIn:t,syncComplete:n})=>{var r;r=safariAPI?legacyGetInputsForLocks():getInputsForLocks();var o=KeeperFill.utils.querySelectorAll("keeper-lock");0===o.length&&r.length?r.forEach(a):(o.forEach(e=>{!e.attachedInput||!isElementInView(e.attachedInput)&&getKeeperPositionablePopup()&&e.id!==getKeeperPositionablePopup().lockId?e.remove():(e.disabled=!t,e.loading=!n,e.reposition(),c(e,e.attachedInput))}),r.filter(e=>{const{keeperLockId:t}=e.dataset;return!t||!KeeperFill.utils.getElementById(t)}).forEach(a));var i=KeeperFill.utils.querySelectorAll("keeper-lock");return i&&i.length?lockCount=i.length:0;function a(e){if(isElementInView(e)){var r=createOuterKeeperElement("keeper-lock");r.style.setProperty("background-image",`url(${getURLForImage("ico-field-fill-lock.svg")})`,"important"),r.style.setProperty("background-size","16px 16px","important"),r.style.setProperty("cursor","pointer","important"),r.style.setProperty("height","16px","important"),r.style.setProperty("width","16px","important"),r.style.setProperty("position","absolute","important"),r.style.setProperty("opacity","0","important"),r.style.setProperty("margin-top","auto","important"),r.style.setProperty("min-width","16px","important"),r.id="k-"+Math.random().toString(36).substr(2),r.attachedInput=e,r.loading=!n,r.disabled=!t,r.onclick=showKeeper,r.addEventListener("mousemove",o),r.addEventListener("mouseover",o),r.addEventListener("mouseout",i),r.addEventListener("mouseleave",i),r.attachedInput&&(r.attachedInput.addEventListener("mousemove",o),r.attachedInput.addEventListener("mouseover",o),r.attachedInput.addEventListener("mouseout",i),r.attachedInput.addEventListener("mouseleave",i)),/https:\/\/www\.myplanrs\.com/.test(location.origin)?(e.parentNode.insertBefore(r,e),r.reposition()):("undefined"!=typeof InstallTrigger&&e.parentNode.appendChild(document.createElement("div")),e.parentNode.appendChild(r),r.reposition()),c(r,e)}function o(e){r.style.animationName="none",r.style.setProperty("opacity","1","important")}function i(e){var t;if(e.target.dataset&&e.target.dataset.keeperLockId?t=KeeperFill.utils.getElementById(e.target.dataset.keeperLockId):"KEEPER-LOCK"===e.target.tagName&&(t=e.target),t){var n=getBoundingClientRect(t),o=e.clientX>n.left&&e.clientX<n.right,i=e.clientY>n.top&&e.clientY<n.bottom,a=!(!getKeeperPositionablePopup||!getKeeperPositionablePopup())&&(e.target.dataset.keeperLockId||t.id)==getKeeperPositionablePopup().lockId;o&&i||a||sendMessage("settings",{type:"GET"},function(e){(e.hoverLocks||void 0===e.hoverLocks)&&(r.style.animationName="",r.style.setProperty("opacity","0","important"))})}}}function s(){-1===dynamicLockHoverStyles.textContent.indexOf(`${this.dataset.keeperLockId}"]:not`)&&(dynamicLockHoverStyles.textContent+=`input[data-keeper-lock-id="${this.dataset.keeperLockId}"]:not(:hover) ~ keeper-lock#${this.dataset.keeperLockId} {animation-name: hide-lock; animation-duration: .5s;}\n`)}function l(){dynamicLockHoverStyles.textContent=dynamicLockHoverStyles.textContent.replace(new RegExp(`.*${this.id}"]:not\\(:hover\\).*`,"g"),"")}function c(n,r){if(t||e.loginPrompt){if(-1===dynamicLockHoverStyles.textContent.indexOf(n.id)&&(dynamicLockHoverStyles.textContent+=`input[data-keeper-lock-id="${n.id}"]:hover ~ keeper-lock#${n.id} {opacity: 1;}\n`,r.addEventListener("mouseenter",s),n.addEventListener("mouseenter",l)),e.showLocks||void 0===e.showLocks)if(n.style.visibility="",e.hoverLocks||void 0===e.hoverLocks){const e=getKeeperPositionablePopup();e&&e.lockId===n.id&&(n.style.animationName="none",n.style.setProperty("opacity","1","important"))}else n.style.animationName="none",n.style.setProperty("opacity","1","important");else{dynamicLockHoverStyles.textContent&&(dynamicLockHoverStyles.textContent="");const e=getKeeperPositionablePopup();e&&e.lockId===n.id?(n.style.animationName="none",n.style.visibility="visible",n.style.opacity="1"):(n.style.visibility="hidden",n.style.animationName="",n.style.opacity="")}n.style.padding="0px 0px 0px 0px"}else n.style.visibility="hidden"}}))}function restoreLocks(){sendMessage("settings",{type:"GET"},function(e){var t=KeeperFill.utils.querySelectorAll("keeper-lock");e.hoverLocks||void 0===e.hoverLocks?t.forEach(function(e){e.onclick=showKeeper,e.style.animationName="",setTimeout(function(){e.style.setProperty("opacity","0","important")},50)}):t.forEach(function(e){e.onclick=showKeeper,e.style.animationName="none",e.style.setProperty("opacity","1","important")})})}function isElementRendered(e){var t=e instanceof HTMLElement?e.getBoundingClientRect():e;return 0!==t.height||0!==t.width}function isElementInView(e){var t=e.getBoundingClientRect();if(t.bottom<=0||t.right<=0)return!1;if(t.top>=window.innerHeight||t.left>=window.innerWidth)return!1;var n=window.getComputedStyle(e);return"hidden"!==n.getPropertyValue("visibility")&&(("0"!==n.getPropertyValue("opacity")||"block"===n.getPropertyValue("display"))&&isElementRendered(t))}function getRecordClickedInVault(e){if(!e)throw new Error("Must give a callback... no more of this message listening nonsense");sendMessage("autoFillRecord",{type:"GET",data:{from:location.href}},e)}function getLastLogOutTime(){return new Promise(e=>{sendMessage("lastLogOutTime",{type:"GET",data:{url:location.href}},t=>{e(null===t?-1/0:t)})})}function updateLastLogOutTime(){return new Promise(e=>{sendMessage("lastLogOutTime",{type:"SET",data:{url:location.href}},function(t){e(t)})})}function getloginHyperLink(){var e,t=["Login","login","Log In","Log in","log in","log on","logon","signin","sign in","sign on","My Account","my account","Account",translateThis("Login"),translateThis("sign_in")],n=KeeperFill.utils.querySelectorAll("a");return Array.prototype.forEach.call(n,function(n){-1!==t.indexOf(n.textContent.trim())&&(e=n)}),e}function imagePath(e){return safariAPI?safari.extension.baseURI+e:"undefined"!=typeof chrome?chrome.extension.getURL(e):"undefined"!=typeof browser?browser.extension.getURL(e):e}function isKeeperVault(){return/^.*keepersecurity.(?:com|eu)$/.test(window.location.hostname)&&"/vault/"===window.location.pathname}function isKeeper(){return/^.*(?:keepersecurity|keeperchat).(?:com|eu)$/.test(window.location.hostname)&&!/checkout/i.test(window.location.pathname)}function getDocumentSearchWord(){return translateThis("Search","search",languageFromTwoLetterCode(document.documentElement.lang))}function getLanguage(){var e=navigator.language.split("-");if(e.length>1){var t=e[0]+"_"+e[1].toUpperCase();if(-1!==["en_US","ar_AE","de_DE","el_GR","en_GB","es_ES","fr_FR","it_IT","iw_IL","ja_JP","ko_KR","nl_NL","pl_PL","pt_BR","pt_PT","ro_RO","ru_RU","sk_SK","zh_CN","zh_HK","zh_TW"].indexOf(t))return t}return languageFromTwoLetterCode(e[0])}function languageFromTwoLetterCode(e){var t;switch(e){case"ar":t="ar_AE";break;case"de":t="de_DE";break;case"el":t="el_GR";break;case"es":t="es_ES";break;case"fr":t="fr_FR";break;case"it":t="it_IT";break;case"he":case"iw":t="iw_IL";break;case"ja":t="ja_JP";break;case"ko":t="ko_KR";break;case"nl":t="nl_NL";break;case"pl":t="pl_PL";break;case"pt":t="pt_PT";break;case"ro":t="ro_RO";break;case"ru":t="ru_RU";break;case"sk":t="sk_SK";break;case"zh":t="zh_CN";break;default:t="en_US"}return t}function translateThis(e,t,n){return n=n||getLanguage(),translation[n]&&translation[n][e]?translation[n][e]:translation.en_US&&translation.en_US[e]?translation.en_US[e]:(console.warn("missing translation key:",e),t||e)}function capitalize(e){return e[0].toUpperCase()+e.slice(1)}function locationTester(e){return e.test(ourUrl.origin+ourUrl.pathname)}function verifyDomainEnforcement(e){for(var t="",n=0;n<e.length;n++)if(t=e[n].replace(/\*/g,"(?:.*)"),locationTester(new RegExp(t,"i")))return!0;return!1}function changePasswordFormSubmitted(e){sendMessage("changePasswordFormSubmitted",{type:"ACTION"})}function getExtensionBaseURL(){let e;return e=safariAPI?safari.extension.baseURI.slice(0,-1):isFirefox?browser.runtime.getURL("").slice(0,-1):isEdge?"ms-browser-extension://"+browser.runtime.id:"chrome-extension://"+chrome.runtime.id}function getURLForImage(e){return getExtensionBaseURL()+"/images/"+e}function handleMessage(e,t,n){if(!nuclearBlacklisted){safariAPI&&!n&&e.callbackId&&(n=function(t){t.callbackId=e.callbackId,sendMessage("requestResponse",{type:"ACTION",data:t})});var r=getKeeperPositionablePopup();switch(e.name){case"MPReentry":r=getKeeperPositionablePopup();var o=e.data,i=o&&o.fromIframe,a=o&&o.closeWindow;r&&!i&&(r.MPReentry&&r.MPReentry(),setTimeout(function(){a&&r.remove()},50));break;case"autoFill":autoFill(e.data,function(e){n({count:e})});break;case"openCreateEditMenu":sendMessage("showCreateEditScreen",{type:"ACTION",itemType:e.data.itemType,edit:e.data.edit});break;case"revertMovableHeader":var s=KeeperFill.utils.querySelectorAll("keeper-header");s&&s[0]&&(s[0]._movable=!1);break;case"contextMenuIndividualFill":var{payload:l,inputField:c}=e.data,u=findInputWithInformation(JSON.parse(c));u&&(u.focus(),u.dispatchEvent(new Event("click")),u.dispatchEvent(new Event("focus")),u.value=l,u.dispatchEvent(new Event("change",{bubbles:!0})),u.dispatchEvent(new Event("input",{bubbles:!0})),"citi.com"===ourUrl.origin.substr(-8)&&u.dispatchEvent(new Event("blur")));break;case"loggedIn":onLoggedIn(),frameIsOverInputLimit?sendMessage("disable_tab",{type:"SET"}):(initPrompts(),sendMessage("enable_tab",{type:"SET"}));break;case"toggleOnlyShowLoginFields":e.data&&(removeAllLocks(),injectInputLocks());break;case"toggleMutationObserver":e.data.showLocks?observer.observe(document.body,{childList:!0,attributes:!0,subtree:!0}):observer.disconnect(),injectInputLocks();break;case"loggedOut":onLoggedOut();break;case"startPromptInCurrentTab":initPrompts();break;case"fillField":{var d={},{lockId:p,fieldData:m,dataKey:f,record:g}=e.data,h=KeeperFill.utils.getElementById(p);function y(){if(h.attachedInput){if(KeeperFill.utils.fillInput(h.attachedInput,m),sendMessage("updateRecordLastFilled",{type:"SET",data:g}),f&&g.record_uid){const e=getSelectorFromElement(h.attachedInput),t=g.extra.smartfill||{};t[e]=f,g.extra.smartfill=t,sendMessage("setSmartfill",{type:"SET",data:g})}h.style.opacity="";var e=findNextLock(h);e&&(e.attachedInput.focus(),e.style.opacity="1"),d={frameSrc:inFrame?document.location.href:null,lockBounds:e?getBoundingClientRect(e):null,lockId:e?e.id:null,inputType:e&&e.attachedInput?e.attachedInput.type:null},n(d)}else{var t=h;if(KeeperFill.utils.fillInput(t,m),sendMessage("updateRecordLastFilled",{type:"SET",data:g}),f&&g.record_uid){const e=getSelectorFromElement(t),n=g.extra.smartfill||{};n[e]=f,g.extra.smartfill=n,sendMessage("setSmartfill",{type:"SET",data:g})}t.style.opacity="";var r=findNextInput(t);r&&(r.focus(),r.style.opacity="1",r.fromContextMenu=!0),d={frameSrc:inFrame?document.location.href:null,lockBounds:r?getBoundingClientRect(r):null,lockId:r?r.id:null,inputType:r?r.type:null},n(d)}}g.secret2===m&&!g.can_view&&h&&"password"!==h.attachedInput.type?n(null):h&&("http:"===getProtocol(ourUrl)?sendMessage("confirmFromIframe",{type:"ACTION",message:translateThis("autofill_fill_http").replace("XXX",location.origin),lock:makeInputReadyForTraffic(h)},function(e){e&&y()}):isTopWindowURLTheFrameURL(ourUrl)?y():sendMessage("confirmFromIframe",{type:"ACTION",message:translateThis("individual_fill_cross_domain").replace("XXX",e.data.record.link).replace("YYY",location.host),lock:makeInputReadyForTraffic(h)},function(e){e&&y()}))}break;case"repositionOverlay":if(!inFrame&&r){const{frameSrc:t,lockBounds:n,lockId:o,wantResponse:i,forceToCenter:a,fromPrompt:s,whichSide:l,fromWhereID:c}=e.data;if(s)r.reposition(null,l,c);else if(i||a)r.classList.add("keeper-float"),r.reposition();else if(o)if(r.lockId=o,t){const e=resolveLockBounds(t,n);e?r.reposition(e):r.reposition()}else r.reposition(n);else r.remove()}break;case"changePasswordReposition":if(!inFrame&&r&&r.lockId){const e=(h=KeeperFill.utils.getElementById(r.lockId))&&h.getBoundingClientRect(),t=r.getBoundingClientRect();if(e&&t){var k=e.left+e.width/2+(t.width-20)>window.innerWidth;if(r.style.margin="0px 0px 0px 0px",r.classList.add("repositioning"),k){const e=window.innerWidth/2-137;r.style.top=.3*window.innerHeight+"px",r.style.left=e+"px"}else r.style.top=e.top-35+"px",r.style.left=e.left+20+"px";overlay_sanity.left=r.style.left,overlay_sanity.top=r.style.top,setTimeout(function(){r.classList.remove("repositioning")},500)}}break;case"openFrame":if(!inFrame&&(r&&r.remove(),e.data)){var{name:v="prompt",lockId:p}=e.data;appendKeeperPromptFrame(v,p).then(function(e){n({loaded:e})})}break;case"closeFrame":!inFrame&&r&&r.remove();break;case"updateFrameHeight":!inFrame&&r&&(r.style.height=e.data.height+20+"px");break;case"toggleHeaderButtons":if(!inFrame&&r&&e){var b=e.data,I=r.querySelector("keeper-iconbutton-done");if(!I){var w=r.querySelector("keeper-div");I=createOuterKeeperElement("keeper-iconbutton-done"),w.appendChild(I),I.style.cursor="pointer",I.setAttribute("keeper-tooltip",translateThis("Fill_and_save"))}var F=r.querySelector("keeper-iconbutton-more")?r.querySelector("keeper-iconbutton-more"):null;I.style.display=b?"block":"none",F&&(F.style.display=b?"none":"")}break;case"toggleMoreIcon":if(!inFrame&&r&&e){var L=e.data;(F=r.querySelector("keeper-iconbutton-more")).style.display=L?"":"none"}break;case"inactivityTimeoutReset":break;case"syncComplete":onSyncComplete();break;case"tryFillCustomFields":{let t=e.data.record;var E=[];if((e.data.matchedFields||[]).forEach(e=>{var t=e[1];t.keeperLockId="",E.push([findInputWithInformation(e[0]),t])}),t&&t.hasOwnProperty("custom")){var x=KeeperFill.detectInputsWithAttrs();if((x=x.map(e=>{var t=e[1];return t.keeperLockId="",[e[0],t]})).length>0){var K=_.differenceWith(x,E,_.isEqual);0==K.length?sendMessage("setTryCustomFillRecord",{type:"SET",data:{}}):sendMessage("lastFillTimeOnInputField",{type:"GET",data:{record:t}},function(e){KeeperFill.executeCustomFieldFill(K,t).then(t=>{sendMessage("setTryCustomFillRecord",{type:"SET",data:{}});var r=!0;e&&e.forEach(e=>{findInputWithInformation(e.field)&&Date.now()-e.time<5e3&&(r=!1,n())});var o=KeeperFill.utils.detectSubmitButton(x)||KeeperFill.utils.getElementById("LoginButton");o&&o.disabled&&(o.disabled=!1),o&&t>=1&&sendMessage("settings",{type:"GET"},e=>{e.autoSubmit&&r&&setTimeout(function(){o.click(),o.ksClickCallback&&o.ksClickCallback()},50)}),n({count:t,submitButton:o})})})}else n()}else n()}break;case"pendingPostRequest":if(isKeeper())return;return getLastLogOutTime().then(e=>{let t=e+5e3>Date.now();(e===-1/0||t)&&saveInputValues()});case"toggleListenerForChangePasswordSubmission":var C=e.data;KeeperFill.detectBestGroups().then(function({changepasswordGroup:e}){if(e){const t=Array.from(e.elems),n=KeeperFill.utils.detectSubmitButton(t);n&&(C?n.addEventListener("click",changePasswordFormSubmitted):n.removeEventListener("click",changePasswordFormSubmitted))}}).catch(function(e){console.log(e)});break;case"updateLocksPayload":var{payload:l,type:P}=e.data;(R=KeeperFill.utils.querySelectorAll("keeper-lock")).forEach(function(e){e.onclick=fillLockAttachedInput.bind(null,e,l,P)});break;case"disableLocks":(R=KeeperFill.utils.querySelectorAll("keeper-lock")).forEach(function(e){e.onclick=function(){}});break;case"restoreLocks":restoreLocks();break;case"showLoggedInKeeper":injectInputLocks(),setTimeout(function(){if(e.data&&e.data.fromContextMenu){var t=e.data&&e.data.input&&JSON.parse(e.data.input);if(t){var r=findInputWithInformation(t);if(r){var o=null;const e=r.dataset.keeperLockId;e?o=KeeperFill.utils.getElementById(e):(o={},r.id||(r.id="appendToKeeper"),o.attachedInput=r,o.fromContextMenu=!0),n?showLoggedInKeeper(o,null,null,null,null,n):showLoggedInKeeper(o)}else i()}else i()}else inFrame||i();function i(){if(document){var e=KeeperFill.utils.querySelector("keeper-lock");e&&(n?showLoggedInKeeper(e,null,null,null,null,n):showLoggedInKeeper(e))}}},100);break;case"transitionPopupOut":if(r=getKeeperPositionablePopup()){switch(!0){case r.classList.contains("fade-in-keeper-browser-extension"):r.classList.remove("fade-in-keeper-browser-extension"),r.classList.add("fade-out-keeper-browser-extension");break;case r.classList.contains("smooth-slide-in-from-left-end-keeper"):r.classList.remove("smooth-slide-in-from-left-end-keeper"),r.classList.add("smooth-slide-out-from-left-keeper");break;case r.classList.contains("smooth-slide-in-from-right-end-keeper"):r.classList.remove("smooth-slide-in-from-right-end-keeper"),r.classList.add("smooth-slide-out-from-right-keeper");break;default:!inFrame&&r&&r.remove()}r.addEventListener("animationend",function(e){(r.classList.contains("fade-out-keeper-browser-extension")||r.classList.contains("smooth-slide-out-from-right-keeper")||r.classList.contains("smooth-slide-out-from-left-keeper"))&&!inFrame&&r&&r.remove()})}break;case"showKeeper":showKeeper({isTrusted:!0});break;case"closeRecordListEventListener":function S(e){window.removeEventListener("mouseup",this),sendMessage("closeRecordList",{type:"ACTION"})}if(window.addEventListener("mouseup",S),!r)return;r.querySelector("keeper-header").addEventListener("mouseup",S);break;case"closeEditCreateMenu":var T=(r=getKeeperPositionablePopup&&getKeeperPositionablePopup())&&r.querySelector("keeper-iconbutton-more keeper-div"),A=r&&r.querySelector("keeper-iconbutton-more svg");A&&(A.style.display="block"),T&&(T.style.display="none");break;case"enabledHoverLock":if(!document)return;(R=KeeperFill.utils.querySelectorAll("keeper-lock"))&&R.forEach(e=>{e.style.animationName="",e.style.setProperty("opacity","0","important")});break;case"disabledHoverLock":if(!document)return;var R;(R=KeeperFill.utils.querySelectorAll("keeper-lock"))&&R.forEach(e=>{e.style.animationName="none",e.style.setProperty("opacity","1","important")});break;case"contextMenuConfirmation":var M;if(e.data.lock?extractIDFromElemFromBG(e.data.lock)&&(M=!0):e.data.input?findInputWithInformation(e.data.input)&&(M=!0):M=!1,M)if(safariAPI&&!window.supportsCrossOriginExtensionFrames)n({canSendMessage:!0});else{let e=document.createElement("iframe");e.src=`${getBaseUrl()}/content_scripts/contextMenuConfirmation.html`,e.style.height="0px",e.style.width="0px",e.style.display="none",document.body.appendChild(e),e.onload=function(){n({canSendMessage:!0})}}break;case"removeContextMenuConfirmation":var O=document.querySelectorAll("iframe");O&&O.forEach(function(e){e.src===`${getBaseUrl()}/content_scripts/contextMenuConfirmation.html`&&document.body.removeChild(e)}),n({});break;case"setTimeout":case"TabChanged":case"tabActivated":case"tabDeactivated":break;case"confirmContextMenuFill":!safariAPI||supportsCrossOriginExtensionFrames||inFrame||(window.confirm(e.data.message)?n({confirm:!0}):n({confirm:!1}));break;case"closeRecordList":case"syncCompleteActiveTab":case"showExtension":case"showPrompt":case"showChangePrompt":case"showSaveOptions":case"settingChanged":case"backgroundError":case"editMode":case"editDone":case"roleEnforcementRestriction":case"updateExtensionClasses":case"changePasswordFlow":case"newPasswordFilled":case"oldPasswordFilled":case"checkChangedPassword":case"showCreateEditScreen":case"vaultForceReload":case"extensionAlive":case"login":case"vaultForceLogin":case"vaultAutoLogin":case"vaultU2FLogin":case"setTimeout":case"closeEditCreateMenuEventListener":case"toVault":case"showMPRentryErrorPopup":break;case"requestResponse":onRequestResponseEvent(e.data);break;case"loggedOut":onLoggedOut();break;case"vaultForceReload":case"extensionAlive":case"login":case"vaultAutoLogin":case"vaultU2FLogin":case"setInactivityTimeoutListener":break;default:console.warn("Unhandled Event Message",e)}}}function getBaseUrl(){let e;return e=safariAPI?safari.extension.baseURI.slice(0,-1):isFirefox?browser.runtime.getURL("").slice(0,-1):isEdge?"ms-browser-extension://"+(chrome||browser).runtime.id:"chrome-extension://"+chrome.runtime.id}function onRequestResponseEvent(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return}if(e._callbackId){var t=e._callbackId;return delete e._callbackId,messageCallbacks.invoke(t,e)}}function removeWebsitePasswordShowHideIcon(e){if(e&&e.elements){var t=Array.from(e.elements).filter(e=>KeeperFill.isVisible(e));t.length<30&&t.forEach(e=>{if(e.parentElement&&e.parentElement.children){var t=e.parentElement;Array.from(t.children).forEach(e=>{!KeeperFill.isShowHideIcon(e)||!e.dataset||e.dataset.keeperLockId||e.value||e.type&&"button"!=e.type&&"submit"!=e.type||"DIV"==e.tagName||"P"==e.tagName||"LABEL"==e.tagName||e.remove()})}})}}function lastClickedInputField(e){let t=null;if(ourUrl){("INPUT"===e.target.tagName||"DIV"===e.target.tagName&&!0===e.target.contentEditable)&&(t=JSON.stringify(makeInputReadyForTraffic(e.target))),sendMessage("lastInputField",{type:"SET",data:{readyInput:t,frameUrl:location.origin,pageUrl:ourUrl.origin}})}}function makeInputReadyForTraffic(e){var t={};return Array.from(e.attributes).forEach(e=>{t[e.name]=e.value}),t}function findInputWithInformation(e){var t="",n=new RegExp(/^[a-zA-Z0-9]/,"i");"string"==typeof e&&(e=JSON.parse(e)),Object.keys(e).forEach(r=>{n.test(e[r])&&(t+="["+r+'="'+e[r]+'"]')});var r=KeeperFill.utils.querySelectorAll("input"+t);return r.length>0?findExactShownInputInList(r):(t="",Object.keys(e).forEach(r=>{KeeperFill.utils.attrList.includes(r)&&n.test(e[r])&&(t+="["+r+'="'+e[r]+'"]')}),findExactShownInputInList(KeeperFill.utils.querySelectorAll("input"+t)))}function extractIDFromElemFromBG(e){var t;return Object.keys(e).forEach(n=>{"id"===n&&(t=KeeperFill.utils.getElementById(e[n]))}),t}function findExactShownInputInList(e){return 0==e.length?null:1==e.length?e[0]:(e.forEach(e=>{KeeperFill.isVisible(e)&&(t=e)}),t);var t}function websiteEyeIconSpecificRemovalList(){ourUrl.host.includes("24hourfitness.com")&&((e=KeeperFill.utils.querySelector("#app #page-content form section .form-group .input-group-btn"))&&(e.remove(),matchInputStyles(Array.from(e.parentElement.querySelectorAll("input")))));if(ourUrl.host.includes("expedia.com")||ourUrl.host.includes("orbitz.com")||ourUrl.host.includes("travelocity.com")){var e=KeeperFill.utils.getElementById("gss-signin-password-icon-button"),t=KeeperFill.utils.getElementById("gss-signup-password-icon-button");e&&(e.style.display="none",matchInputStyles(Array.from(e.parentElement.querySelectorAll("input")))),t&&(t.style.display="none",matchInputStyles(Array.from(e.parentElement.querySelectorAll("input"))))}}function matchInputStyles(e){e&&e.forEach(e=>{e.style.marginRight=e.style.marginLeft,e.style.paddingRight=e.style.paddingLeft,e.style.borderRight=e.style.borderLeft})}function removeListenersFromCraigSpecificSites(e){if(e.host.includes("test.point74.co.uk")){var t=KeeperFill.utils.querySelectorAll(".ui-dialog.ui-widget.ui-widget-content.ui-corner-all.ui-front");if(t){t.forEach(e=>{e.onmousedown=function(){}});let e=document.createElement("script");e.textContent="\n      var removeMouseDown = KeeperFill.utils.querySelectorAll('.ui-dialog.ui-widget.ui-widget-content.ui-corner-all.ui-front');\n      if(removeMouseDown){\n        removeMouseDown.forEach(elem => {\n          if($ && $(elem)){\n            $(elem).unbind('mousedown');\n          }\n        })\n      }\n      ",document.body.append(e)}}}function sanityCheckAllImportantCSS(e){return Object.defineProperty(e.style,"opacity",{get:function(){return this._opacity},set:function(e){this._opacity="1"}}),e}function getProtocol(e){return new URL(e).protocol}function isTopWindowURLTheFrameURL(e){return e.host===new URL(location.href).host}window.addEventListener("mousedown",lastClickedInputField);