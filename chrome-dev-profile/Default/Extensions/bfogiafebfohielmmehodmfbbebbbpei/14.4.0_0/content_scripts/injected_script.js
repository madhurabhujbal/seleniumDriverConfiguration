var activityTimeout,ourUrl;sendMessage("checkIfSSOLoginScreen",{type:"ACTION",data:window.name});var nuclearBlacklisted,sameLoadSavePrompt,maskedInputs,noReregister,mutationCallback,observer,dynamicLockHoverStyles=document.createElement("style"),lock_sanity={},lastLookedAtMutation={},promptClearArray=[],locationClearArray=[],overlay_sanity={left:"",top:""},INPUT_LIMIT=50,frameIsOverInputLimit=!1,mutationTimeout=null,crossOriginAutoFillWhitelist={siteMappings:[{target:new URL("https://www.mymerrill.com/ml/home.aspx"),allowed:[new URL("https://olui2.fs.ml.com/mlogin/Login.aspx")]},{target:new URL("https://www.bankoncb.com"),allowed:[new URL("https://hcsbpt.secure.fundsxpress.com/piles/fxweb.pile/custom_login")]},{target:new URL("https://www.cnbc.com"),allowed:[new URL("https://surf.nbcuni.com/dialog.php"),new URL("https://surf.nbcuni.com/rdk/dispatcher.php")]},{target:new URL("https://onsite-support.lightspeedhq.com/hc"),allowed:[new URL("https://retail-support.zendesk.com/auth/v2/login/signin")]},{target:new URL("https://github.com"),allowed:[new URL("https://www.zuora.com/apps/PublicHostedPageLite.do")]},{target:new URL("https://billing.indeed.com"),allowed:[new URL("https://www.chasepaymentechhostedpay.com/hpf/1_1")]},{target:new URL("https://pagerduty.com"),allowed:[new URL("https://www.zuora.com/apps/PublicHostedPageLite.do")]},{target:/(?:www|keeper)\.atlassian\.(?:com|net)/i,allowed:[/^secure\.na\.tnspayments\.com$/i]},{target:new URL("https://www.costco.com"),allowed:[new URL("https://na.accpg.accertify.net/form/version/39/merchant/COST-BC0847/role/number/inputField.do")]},{target:new URL("https://www.costco.com"),allowed:[new URL("https://na.accpg.accertify.net/form/version/39/merchant/COST-BC0847/role/securityCode/inputField.do")]},{target:new URL("https://help.ubnt.com"),allowed:[new URL("https://ubnt.zendesk.com/auth/v2/login/signin")]},{target:new URL("https://capitalgroup.com/advisor/accounts/login.htm"),allowed:[new URL("https://accounts.americanfunds.com")]},{target:new URL("https://talent.stackoverflow.com/checkout"),allowed:[new URL("https://assets.braintreegateway.com/")]}],vendorDomains:[new URL("https://applet.danid.dk"),new URL("https://m.stripe.network"),new URL("https://js.stripe.com"),new URL("https://checkout.shopify.com"),new URL("https://api.recurly.com/js")]};function checkCrossOriginAllowed(e,t){let n=crossOriginAutoFillWhitelist.vendorDomains.some(e=>{try{return e.test(t)}catch(n){return e.host===t}});return n||(n=crossOriginAutoFillWhitelist.siteMappings.some(({target:n,allowed:o})=>{try{if(n.test(e))return o.some(e=>e.test(t))}catch(a){try{var r=new URL(e);if(n.host===r.host)return o.some(e=>{try{return e.test(t)}catch(n){return e.host===t}})}catch(e){}}}))}function initPrompts(){var e=3,t=0,n=!1,o=setInterval(l,1e3);promptClearArray.push(o);var r=3,a=0,i=!1,s=setInterval(function(){if(KeeperPromptManager.currentUrl!==location.origin+location.pathname&&r>a&&!i)KeeperPromptManager.currentUrl=location.origin+location.pathname,a++,KeeperPromptManager.hasPrompted||(o=setInterval(l,1e3),promptClearArray.push(o));else{if(i=!0,a=0,locationClearArray.forEach(e=>{clearInterval(e)}),locationClearArray.length>50)for(var e=0;e<locationClearArray.length;e++)locationClearArray.shift();window.addEventListener("click",function(){if(i=!0,a=0,locationClearArray.forEach(e=>{clearInterval(e)}),locationClearArray.length>50)for(var e=0;e<locationClearArray.length;e++)locationClearArray.shift();s=setInterval(p,1e3),locationClearArray.push(s),window.removeEventListener("click",this)})}},1e3);function l(){if(!KeeperPromptManager.hasPrompted&&e>t&&!n)inFrame||sendMessage("fillCustomFields",{type:"ACTION"},function(){}),KeeperPromptManager.tryToPrompt(),t++;else{if(n=!0,t=0,promptClearArray.forEach(e=>{clearInterval(e)}),locationClearArray.length>50)for(var o=0;o<locationClearArray.length;o++)locationClearArray.shift();window.addEventListener("click",c)}}function c(){if(n=!1,t=0,promptClearArray.forEach(e=>{clearInterval(e)}),locationClearArray.length>50)for(var e=0;e<locationClearArray.length;e++)locationClearArray.shift();o=setInterval(l,1e3),promptClearArray.push(o),window.removeEventListener("click",this)}function p(){if(KeeperPromptManager.currentUrl!==location.origin+location.pathname&&r>a&&!i){KeeperPromptManager.currentUrl=location.origin+location.pathname;a++;if(!KeeperPromptManager.hasPrompted){o=setInterval(l,1e3);promptClearArray.push(o)}}else{i=true;a=0;locationClearArray.forEach(e=>{clearInterval(e)});if(locationClearArray.length>50){for(var e=0;e<locationClearArray.length;e++){locationClearArray.shift()}}window.addEventListener("click",t)}function t(){if(i=!0,a=0,locationClearArray.forEach(e=>{clearInterval(e)}),locationClearArray.length>50){for(var e=0;e<locationClearArray.length;e++){locationClearArray.shift()}}s=setInterval(p,1e3),locationClearArray.push(s),window.removeEventListener("click",this)}}locationClearArray.push(s),inFrame||sendMessage("changePasswordPending",{type:"GET"},function(e){e&&showRevertScreen(e)}),noReregister||KeeperFill.detectBestGroups().then(({registrationGroup:e})=>{if(e&&!inFrame){var t=KeeperFill.utils.detectSubmitButton(e.elems,e.ancestor);if(t){function n(){sendMessage("isLoggedIn",{type:"GET"},function(t){t&&allFieldsHaveInput(e&&e.elems?e.elems:null)&&KeeperPromptManager.tryReRegistration(function(e){var t,n;for(var o of e.keys())(KeeperFill.isEmail(o)||KeeperFill.isLogin(o))&&(t=o.value||o.textContent),(KeeperFill.isPassword(o)||KeeperFill.isNewPassword(o)||KeeperFill.isOldPassword(o))&&(n=o.value||o.textContent);return t&&n?{secret1:t,secret2:n,title:document.title,link:location.origin+location.pathname}:null}(e.elems))})}t.addEventListener("click",function(){setTimeout(n,2e3)})}}}),sendMessage("promptableLoginData",{type:"GET"},e=>{e&&e.promptableLoginData&&!inFrame&&KeeperFill.detectBestGroups().then(({changepasswordGroup:t,registrationGroup:n,loginGroup:o})=>{t||n||o&&!(o&&o.elems.size<2)?sendMessage("clearPromptableLoginData",{type:"SET"}):KeeperPromptManager.trySavePrompt(e)})}),document.body?document.body.addEventListener("input",function(e){e.target.setAttribute("data-keeper-edited","yes")}):setTimeout(function(){document.body.addEventListener("input",function(e){e.target.setAttribute("data-keeper-edited","yes")})},50),window.addEventListener("beforeunload",function(e){saveInputValues()}),document.addEventListener("click",function(e){var t=e.target.textContent.trim();if(/^(?:sign|log)[ ]?out$/i.test(t))return updateLastLogOutTime().then(()=>{}).catch(e=>{console.log(e)})})}function refineInputCheck(e){return KeeperFill.utils.detectInputElements().length>e}function locationTester(e){return e.test(ourUrl.origin+ourUrl.pathname)}!function(){function e(){if(nuclearBlacklisted=[/www\.google\.com\/search/i,/mail\.google\.com/i,/hangouts\.google\.com/i,/console\.aws\.amazon\.com/i,/www\.netflix\.com\/(?:browse|kids|manageprofiles)/i,/email09\.secureserver\.net\/pcompose\.php/i].some(locationTester),sameLoadSavePrompt=[/^https:\/\/www\.target\.com\/gsp\/static\/v1$/i,/^https:\/\/lms\.schwab\.com\/Login$/i,/^https:\/\/olui2\.fs\.ml\.com\/mlogin\/Login\.aspx$/i].some(locationTester),maskedInputs=[{url:/https:\/\/online\.citi\.com\/US\/login\.do/i,username:"username",password:"password"},{url:/https:\/\/www\.bankofamerica\.com/i,username:"onlineId",password:"passcode"}].find(e=>locationTester(e.url)),noReregister=[/https:\/\/www6.rbc.com\/webapp\/ukv0\/signin\/logon.xhtml/i,/https:\/\/www.reddit.com\/login/i,/signup.jamfcloud.com\/success/i].some(locationTester),mutationCallback=debounce(function(e){var t=e.slice();e.length=0,null===dynamicLockHoverStyles.parentNode&&document.body.appendChild(dynamicLockHoverStyles),t.length&&setTimeout(injectInputLocks,100)},800),!document.body){var t=document.querySelector("frameset");if(!t)return void setTimeout(e,10);document.body=t}document.body.onmousedown=function(){},frameIsOverInputLimit=refineInputCheck(INPUT_LIMIT),safariAPI||addMessageListener(onMessage),sendMessage("enforcements",{type:"GET"},function(e){var t=!1;if(e&&e.restrict_domain_access&&(t=verifyDomainEnforcement(e.restrict_domain_access.split(","))),!t&&!nuclearBlacklisted){sendMessage("isLoggedIn",{type:"GET"},function(e){sendMessage("settings",{type:"GET"},function(t){e?(onLoggedIn(),frameIsOverInputLimit&&t.disablePrompt?sendMessage("disable_tab",{type:"SET"}):(initPrompts(),sendMessage("enable_tab",{type:"SET"}))):(onLoggedOut(),KeeperPromptManager.tryToPrompt())})});var n=null;if(window.addEventListener("scroll",function(){clearTimeout(n),n=setTimeout(injectInputLocks,250)}),safariAPI){var o=null;window.addEventListener("animationend",function(){clearTimeout(o),o=setTimeout(injectInputLocks,250)})}var r=[];observer=new MutationObserver(function(e){var t=e.filter(function(e){if(_.isEqual(lastLookedAtMutation.target,e.target))return!1;lastLookedAtMutation=e;var t="keeper-lock"!==e.target.nodeName.toLowerCase(),n=void 0===e.target.innertext,o=e.target.innerText?-1===e.target.innerText.indexOf("keeper-lock"):null;return t&&(n||o)});Array.prototype.push.apply(r,t),mutationCallback(r)}),sendMessage("mutation_observer_data",{type:"GET"},function({settings:e,isLoggedIn:t}){t&&e.showLocks&&(document.body?observer.observe(document.body,{childList:!0,attributes:!0,subtree:!0}):setTimeout(function(){observer.observe(document.body,{childList:!0,attributes:!0,subtree:!0})},50))})}})}function t(e){75===e.keyCode&&e.shiftKey&&(e.ctrlKey||e.metaKey)&&sendMessage("execute_browser_action",{type:"ACTION"})}safariAPI?document.addEventListener("DOMContentLoaded",function(){addMessageListener(onMessage),document.addEventListener("keydown",t),sendMessage("getLocationOfTopWindow",{type:"GET"},function(t){t&&(ourUrl=new URL(t),e())})}):sendMessage("getLocationOfTopWindow",{type:"GET"},function(t){t&&(ourUrl=new URL(t),e())})}();let countForDebounce=0;function debounce(e,t,n){var o;return function(){var r=this,a=arguments,i=function(){o=null,n||e.apply(r,a)},s=n&&!o;countForDebounce>100?(countForDebounce=0,i()):(countForDebounce++,clearTimeout(o)),o=setTimeout(i,t),s&&e.apply(r,a)}}