function pkcs1unpad2hex(e,r){for(var t=e.toByteArray(),n=0;n<t.length&&0==t[n];)++n;if(t.length-n!=r-1||2!=t[n])return null;for(++n;0!=t[n];)if(++n>=t.length)return null;for(var a="";++n<t.length;){var i=255&t[n];a+=i<16?"0"+i.toString(16):i.toString(16)}return a}function generateKeyPair(e){return new Promise((r,t)=>{sendMessage("generateKeyPair",{type:"ACTION",length:e},e=>{var t=new RSAKey;t.setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.qi);var n=convert.RSAtoASN1Hex(!1,t),a=convert.RSAtoASN1Hex(!0,t);r({public_key:n,private_key:a})})})}RSAKey.prototype.readPKCS5PrvKeyHex=function(e){var r=RSAKey.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])};